# Perhitungan & Statistik Dasar

Pada dasarnya SQL bukan saja hanya dapat dipergunakan untuk melakukan manajemen database. Tetapi, dapat juga melakukan perhitungan matematika dan statistika dasar yang pada akhirnya dapat disimpan pada database untuk keperluan analisa. Secara spesifik, pelatihan ini akan membahas beberapa diantaranya yakni mengenai penggunaan fungsi sklar dan fungsi agregat.

## Fungsi Skalar vs Agregat

**Fungsi skalar** atau fungsi math dalam SQL digunakan untuk mengembalikan nilai tunggal *(single value)* dari suatu nilai input yang diberikan pada perintah sebelumnya. Sedangkan, **Fungsi agregat** dalam SQL digunakan untuk melakukan perhitungan matematika pada sekelompok nilai dan kemudian mengembalikan nilai tunggal.

### Perhitungan Skalar

Sebelum kita memulai melakukan beberapa perhitungan skalar pada data yang kita pilih dari database. Pertama-tama, mari kita lihat dulu isi data pada tabel berikut:

```{r include=FALSE}
library(reticulate)
library(Rcpp)
# conda_list()
use_condaenv("base", required = TRUE)
```

```{python, eval=F}
from sqlalchemy import create_engine
import pymysql
import pandas as pd

# membuat engine
engine = create_engine("mysql+pymysql://{user}:{pw}@localhost/{db}"
                       .format(user="bakti",
                               pw="123",
                               db="jne2"))
# engine koneksi ke database
db_enco = engine.connect()

# Perintah SQL 
sql = "inventory_items"
       
# Eksekusi perintah  SQL dengan Python (panda)
pd.read_sql(sql,db_enco)
```

Berikut ini adalah beberapa contoh dan deskripsi Fungsi Skalar yang terdapat dalam SQL:

<img align="middle" src="images/bab2/fungsi_skalar.png"  width = 100% />

**Syntax fungsi `ABS()`** adalah sebagai untuk menampilkan nilai absolut dari suatu bilangan bulat. Sebelum memulai menggunakan fungsi ABS(), perlu untuk membuat objek koneksi dan kursor eksekusinya terlebih dahulu.

```{python, eval=F}
# import module 
import mysql.connector

# koneksi salah satu database MySQl ke Python
db1 = mysql.connector.connect(
  host='localhost',
  user='bakti',
  passwd='123',
  database='jne2'
)

# membuat objek 'cursor` sebagai kata kunci eksekusi SQL
cursor1 = db1.cursor()
```

Selanjutnya, berikut ini diperlihatkan contoh penerapan fungsi ABS().

```{python, eval=F}
# Perintah SQL 
sql = "SELECT ABS(cost) \
       FROM  inventory_items \
       WHERE product_id=16898"
       
# Eksekusi perintah  SQL
cursor1.execute(sql)

# menampilkan daftar tabel
for data in cursor1:
  print(data) 
```
Dari hasil diatas diperlihatkan beberapa hasil yang sama. Untuk menangani hal tersebut, perhatikan koding berikut:

```{python, eval=F}
# Perintah SQL 
sql = "SELECT DISTINCT ABS(cost) \
       FROM  inventory_items \
       WHERE product_id=16898"
       
# Eksekusi perintah  SQL
cursor1.execute(sql)

# menampilkan daftar tabel
for data in cursor1:
  print(data) 
```

### Perhitungan Agregat

Berikut ini adalah beberapa contoh dan deskripsi Fungsi Agregat yang terdapat dalam SQL:

<img align="middle" src="images/bab2/fungsi_agregat.png"  width = 100% />

**Fungsi COUNT(*)** mengembalikan jumlah baris yang dikembalikan oleh pernyataan SELECT, termasuk NULL dan duplikat, sedangkan COUNT(column) mengembalikan jumlah baris yang dikembalikan oleh klausa SELECT.


```{python, eval=F}
# Perintah SQL 
sql = "SELECT COUNT(product_category) \
       FROM inventory_items \
       WHERE cost<5"
       
# Eksekusi perintah  SQL
cursor1.execute(sql)

# menampilkan daftar tabel
for data in cursor1:
  print(data) 
```





