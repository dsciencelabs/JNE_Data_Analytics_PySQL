<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Bab 4 Join Tabel &amp; Subkueri | WORKSHOP</title>
  <meta name="description" content="Buku ini dipersembahkan kepada para peserta Workshop JNE yang berjudul; Data Analytics with Python+SQL. E-book ini diharapkan untuk dapat mempermudah pembelajaran (workshop) dengan menyediakan materi interaktif yang dapat diakases secara online. Materi tersebut akan kuis, demonstrasi komputer, grafik interaktif, video, dan sejenisnya." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Bab 4 Join Tabel &amp; Subkueri | WORKSHOP" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Buku ini dipersembahkan kepada para peserta Workshop JNE yang berjudul; Data Analytics with Python+SQL. E-book ini diharapkan untuk dapat mempermudah pembelajaran (workshop) dengan menyediakan materi interaktif yang dapat diakases secara online. Materi tersebut akan kuis, demonstrasi komputer, grafik interaktif, video, dan sejenisnya." />
  <meta name="github-repo" content="dsciencelabs/Bookdown-Tempalate_R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bab 4 Join Tabel &amp; Subkueri | WORKSHOP" />
  
  <meta name="twitter:description" content="Buku ini dipersembahkan kepada para peserta Workshop JNE yang berjudul; Data Analytics with Python+SQL. E-book ini diharapkan untuk dapat mempermudah pembelajaran (workshop) dengan menyediakan materi interaktif yang dapat diakases secara online. Materi tersebut akan kuis, demonstrasi komputer, grafik interaktif, video, dan sejenisnya." />
  

<meta name="author" content="Bakti Siregar, M.Sc" />


<meta name="date" content="2023-07-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="perhitungan-statistik-dasar.html"/>
<link rel="next" href="w1h-visualisasi.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><center><img src="images/JNE_Py_SQL.png" alt="logo" width="50%" height="50%"style="margin: 15px 0 0 0"></center></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html"><i class="fa fa-check"></i>Kata Pengantar</a>
<ul>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#maksud-tujuan"><i class="fa fa-check"></i>Maksud &amp; Tujuan</a></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#jadwal-kegiatan"><i class="fa fa-check"></i>Jadwal Kegiatan</a>
<ul>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#pertemuan-1"><i class="fa fa-check"></i>Pertemuan 1</a></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#pertemuan-2"><i class="fa fa-check"></i>Pertemuan 2</a></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#pertemuan-3"><i class="fa fa-check"></i>Pertemuan 3</a></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#pertemuan-4"><i class="fa fa-check"></i>Pertemuan 4</a></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#pertemuan-5"><i class="fa fa-check"></i>Pertemuan 5</a></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#pertemuan-6"><i class="fa fa-check"></i>Pertemuan 6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#pemateri-mediator"><i class="fa fa-check"></i>Pemateri &amp; Mediator</a></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#para-peserta"><i class="fa fa-check"></i>Para Peserta</a></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#manfaat-dan-fasilitas"><i class="fa fa-check"></i>Manfaat dan Fasilitas</a></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#syarat-peserta"><i class="fa fa-check"></i>Syarat Peserta</a></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#masukan-saran"><i class="fa fa-check"></i>Masukan &amp; Saran</a></li>
<li class="chapter" data-level="" data-path="kata-pengantar.html"><a href="kata-pengantar.html#ucapan-terima-kasih"><i class="fa fa-check"></i>Ucapan Terima Kasih</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="pendahuluan.html"><a href="pendahuluan.html"><i class="fa fa-check"></i><b>1</b> Pendahuluan</a>
<ul>
<li class="chapter" data-level="1.1" data-path="pendahuluan.html"><a href="pendahuluan.html#apa-itu-sbd"><i class="fa fa-check"></i><b>1.1</b> Apa itu SBD?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="pendahuluan.html"><a href="pendahuluan.html#komponen-sbd"><i class="fa fa-check"></i><b>1.1.1</b> Komponen SBD</a></li>
<li class="chapter" data-level="1.1.2" data-path="pendahuluan.html"><a href="pendahuluan.html#manfaat-sbd"><i class="fa fa-check"></i><b>1.1.2</b> Manfaat SBD</a></li>
<li class="chapter" data-level="1.1.3" data-path="pendahuluan.html"><a href="pendahuluan.html#definisi-sql-vs-nosql"><i class="fa fa-check"></i><b>1.1.3</b> Definisi SQL vs NoSQL</a></li>
<li class="chapter" data-level="1.1.4" data-path="pendahuluan.html"><a href="pendahuluan.html#perbedaan-sql-vs-nosql"><i class="fa fa-check"></i><b>1.1.4</b> Perbedaan SQL vs NoSQL</a></li>
<li class="chapter" data-level="1.1.5" data-path="pendahuluan.html"><a href="pendahuluan.html#top-7-sql"><i class="fa fa-check"></i><b>1.1.5</b> Top 7 SQL</a></li>
<li class="chapter" data-level="1.1.6" data-path="pendahuluan.html"><a href="pendahuluan.html#top-8-nosql"><i class="fa fa-check"></i><b>1.1.6</b> Top 8 NoSQL</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="pendahuluan.html"><a href="pendahuluan.html#mengapa-python-sql"><i class="fa fa-check"></i><b>1.2</b> Mengapa Python &amp; SQL?</a></li>
<li class="chapter" data-level="1.3" data-path="pendahuluan.html"><a href="pendahuluan.html#mysql-vs-postgresql"><i class="fa fa-check"></i><b>1.3</b> MySQL vs PostgreSQL</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="pendahuluan.html"><a href="pendahuluan.html#kelebihan"><i class="fa fa-check"></i><b>1.3.1</b> Kelebihan</a></li>
<li class="chapter" data-level="1.3.2" data-path="pendahuluan.html"><a href="pendahuluan.html#kekurangan"><i class="fa fa-check"></i><b>1.3.2</b> Kekurangan</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="pendahuluan.html"><a href="pendahuluan.html#instalasi-python-anaconda"><i class="fa fa-check"></i><b>1.4</b> Instalasi Python (Anaconda)</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="pendahuluan.html"><a href="pendahuluan.html#open-site"><i class="fa fa-check"></i><b>1.4.1</b> Open site</a></li>
<li class="chapter" data-level="1.4.2" data-path="pendahuluan.html"><a href="pendahuluan.html#buka-file-exe-yang-telah-didownload"><i class="fa fa-check"></i><b>1.4.2</b> Buka file exe yang telah didownload</a></li>
<li class="chapter" data-level="1.4.3" data-path="pendahuluan.html"><a href="pendahuluan.html#baca-perjanjian-lisensi-dan-klik-i-agree."><i class="fa fa-check"></i><b>1.4.3</b> Baca perjanjian lisensi dan klik <strong>I Agree</strong>.</a></li>
<li class="chapter" data-level="1.4.4" data-path="pendahuluan.html"><a href="pendahuluan.html#click-on-next"><i class="fa fa-check"></i><b>1.4.4</b> Click on Next</a></li>
<li class="chapter" data-level="1.4.5" data-path="pendahuluan.html"><a href="pendahuluan.html#catat-lokasi-penginstalan-anda-lalu-klik-next."><i class="fa fa-check"></i><b>1.4.5</b> Catat lokasi penginstalan Anda, lalu klik Next.</a></li>
<li class="chapter" data-level="1.4.6" data-path="pendahuluan.html"><a href="pendahuluan.html#customiza-anaconda"><i class="fa fa-check"></i><b>1.4.6</b> Customiza Anaconda</a></li>
<li class="chapter" data-level="1.4.7" data-path="pendahuluan.html"><a href="pendahuluan.html#setup-complete"><i class="fa fa-check"></i><b>1.4.7</b> Setup Complete</a></li>
<li class="chapter" data-level="1.4.8" data-path="pendahuluan.html"><a href="pendahuluan.html#selesai"><i class="fa fa-check"></i><b>1.4.8</b> Selesai</a></li>
<li class="chapter" data-level="1.4.9" data-path="pendahuluan.html"><a href="pendahuluan.html#video-instalasi"><i class="fa fa-check"></i><b>1.4.9</b> Video Instalasi</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="pendahuluan.html"><a href="pendahuluan.html#instalasi-mysql-xampp"><i class="fa fa-check"></i><b>1.5</b> Instalasi MySQL (XAMPP)</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="pendahuluan.html"><a href="pendahuluan.html#download-aplikasi-xampp"><i class="fa fa-check"></i><b>1.5.1</b> Download Aplikasi XAMPP</a></li>
<li class="chapter" data-level="1.5.2" data-path="pendahuluan.html"><a href="pendahuluan.html#install-aplikasi"><i class="fa fa-check"></i><b>1.5.2</b> Install Aplikasi</a></li>
<li class="chapter" data-level="1.5.3" data-path="pendahuluan.html"><a href="pendahuluan.html#pilih-folder"><i class="fa fa-check"></i><b>1.5.3</b> Pilih Folder</a></li>
<li class="chapter" data-level="1.5.4" data-path="pendahuluan.html"><a href="pendahuluan.html#jalankan-proses-instalasi"><i class="fa fa-check"></i><b>1.5.4</b> Jalankan proses Instalasi</a></li>
<li class="chapter" data-level="1.5.5" data-path="pendahuluan.html"><a href="pendahuluan.html#xampp-sudah-terinstall"><i class="fa fa-check"></i><b>1.5.5</b> XAMPP sudah terinstall</a></li>
<li class="chapter" data-level="1.5.6" data-path="pendahuluan.html"><a href="pendahuluan.html#video-instalasi-xampp"><i class="fa fa-check"></i><b>1.5.6</b> Video Instalasi XAMPP</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="pendahuluan.html"><a href="pendahuluan.html#instalasi-postgresql"><i class="fa fa-check"></i><b>1.6</b> Instalasi PostgreSQL</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="pendahuluan.html"><a href="pendahuluan.html#buka-browser"><i class="fa fa-check"></i><b>1.6.1</b> Buka Browser</a></li>
<li class="chapter" data-level="1.6.2" data-path="pendahuluan.html"><a href="pendahuluan.html#cek-option"><i class="fa fa-check"></i><b>1.6.2</b> Cek Option</a></li>
<li class="chapter" data-level="1.6.3" data-path="pendahuluan.html"><a href="pendahuluan.html#pilih-postgresql-version"><i class="fa fa-check"></i><b>1.6.3</b> Pilih PostgreSQL version</a></li>
<li class="chapter" data-level="1.6.4" data-path="pendahuluan.html"><a href="pendahuluan.html#open-exe-file"><i class="fa fa-check"></i><b>1.6.4</b> Open exe file</a></li>
<li class="chapter" data-level="1.6.5" data-path="pendahuluan.html"><a href="pendahuluan.html#pilih-folder-1"><i class="fa fa-check"></i><b>1.6.5</b> Pilih folder</a></li>
<li class="chapter" data-level="1.6.6" data-path="pendahuluan.html"><a href="pendahuluan.html#select-components"><i class="fa fa-check"></i><b>1.6.6</b> Select components</a></li>
<li class="chapter" data-level="1.6.7" data-path="pendahuluan.html"><a href="pendahuluan.html#check-data-location"><i class="fa fa-check"></i><b>1.6.7</b> Check data location</a></li>
<li class="chapter" data-level="1.6.8" data-path="pendahuluan.html"><a href="pendahuluan.html#masukan-password"><i class="fa fa-check"></i><b>1.6.8</b> Masukan Password</a></li>
<li class="chapter" data-level="1.6.9" data-path="pendahuluan.html"><a href="pendahuluan.html#cek-opsi-port"><i class="fa fa-check"></i><b>1.6.9</b> Cek opsi port</a></li>
<li class="chapter" data-level="1.6.10" data-path="pendahuluan.html"><a href="pendahuluan.html#cek-summary"><i class="fa fa-check"></i><b>1.6.10</b> Cek Summary</a></li>
<li class="chapter" data-level="1.6.11" data-path="pendahuluan.html"><a href="pendahuluan.html#ready-to-install"><i class="fa fa-check"></i><b>1.6.11</b> Ready to Install</a></li>
<li class="chapter" data-level="1.6.12" data-path="pendahuluan.html"><a href="pendahuluan.html#check-stack-builder-prompt"><i class="fa fa-check"></i><b>1.6.12</b> Check stack builder prompt</a></li>
<li class="chapter" data-level="1.6.13" data-path="pendahuluan.html"><a href="pendahuluan.html#launch-postgresql"><i class="fa fa-check"></i><b>1.6.13</b> Launch PostgreSQL</a></li>
<li class="chapter" data-level="1.6.14" data-path="pendahuluan.html"><a href="pendahuluan.html#check-pgadmin"><i class="fa fa-check"></i><b>1.6.14</b> Check pgAdmin</a></li>
<li class="chapter" data-level="1.6.15" data-path="pendahuluan.html"><a href="pendahuluan.html#cari-postgresql-15"><i class="fa fa-check"></i><b>1.6.15</b> Cari PostgreSQL 15</a></li>
<li class="chapter" data-level="1.6.16" data-path="pendahuluan.html"><a href="pendahuluan.html#enter-password"><i class="fa fa-check"></i><b>1.6.16</b> Enter password</a></li>
<li class="chapter" data-level="1.6.17" data-path="pendahuluan.html"><a href="pendahuluan.html#cek-dashboard"><i class="fa fa-check"></i><b>1.6.17</b> Cek Dashboard</a></li>
<li class="chapter" data-level="1.6.18" data-path="pendahuluan.html"><a href="pendahuluan.html#video-instalasi-postgresql"><i class="fa fa-check"></i><b>1.6.18</b> Video Instalasi PostgreSQL</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="pendahuluan.html"><a href="pendahuluan.html#praktikal-hands-on"><i class="fa fa-check"></i><b>1.7</b> Praktikal (Hands On)</a></li>
<li class="chapter" data-level="1.8" data-path="pendahuluan.html"><a href="pendahuluan.html#latihan"><i class="fa fa-check"></i><b>1.8</b> Latihan</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html"><i class="fa fa-check"></i><b>2</b> Eksplorasi Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#koneksi-mysql-dan-python"><i class="fa fa-check"></i><b>2.1</b> Koneksi MySQL dan Python</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#memeriksa-daftar-database"><i class="fa fa-check"></i><b>2.1.1</b> Memeriksa Daftar Database</a></li>
<li class="chapter" data-level="2.1.2" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#membuat-database"><i class="fa fa-check"></i><b>2.1.2</b> Membuat Database</a></li>
<li class="chapter" data-level="2.1.3" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#menghapus-database"><i class="fa fa-check"></i><b>2.1.3</b> Menghapus Database</a></li>
<li class="chapter" data-level="2.1.4" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#memeriksa-daftar-tabel"><i class="fa fa-check"></i><b>2.1.4</b> Memeriksa Daftar Tabel</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#cruda-tabel"><i class="fa fa-check"></i><b>2.2</b> CRUDA Tabel</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#create"><i class="fa fa-check"></i><b>2.2.1</b> CREATE</a></li>
<li class="chapter" data-level="2.2.2" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#read"><i class="fa fa-check"></i><b>2.2.2</b> READ</a></li>
<li class="chapter" data-level="2.2.3" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#update"><i class="fa fa-check"></i><b>2.2.3</b> UPDATE</a></li>
<li class="chapter" data-level="2.2.4" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#delete"><i class="fa fa-check"></i><b>2.2.4</b> DELETE</a></li>
<li class="chapter" data-level="2.2.5" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#alter"><i class="fa fa-check"></i><b>2.2.5</b> ALTER</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#filter-tabel"><i class="fa fa-check"></i><b>2.3</b> Filter Tabel</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#select"><i class="fa fa-check"></i><b>2.3.1</b> SELECT</a></li>
<li class="chapter" data-level="2.3.2" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#where"><i class="fa fa-check"></i><b>2.3.2</b> WHERE</a></li>
<li class="chapter" data-level="2.3.3" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#order-by"><i class="fa fa-check"></i><b>2.3.3</b> ORDER BY</a></li>
<li class="chapter" data-level="2.3.4" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#limit"><i class="fa fa-check"></i><b>2.3.4</b> LIMIT</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#tugas-kelompok"><i class="fa fa-check"></i><b>2.4</b> Tugas Kelompok</a></li>
<li class="chapter" data-level="2.5" data-path="eksplorasi-data.html"><a href="eksplorasi-data.html#cara-mengatasi-xampp-tidak-berfungsi-dengan-baik"><i class="fa fa-check"></i><b>2.5</b> Cara mengatasi XAMPP tidak berfungsi dengan baik</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="perhitungan-statistik-dasar.html"><a href="perhitungan-statistik-dasar.html"><i class="fa fa-check"></i><b>3</b> Perhitungan &amp; Statistik Dasar</a>
<ul>
<li class="chapter" data-level="3.1" data-path="perhitungan-statistik-dasar.html"><a href="perhitungan-statistik-dasar.html#fungsi-skalar-vs-agregat"><i class="fa fa-check"></i><b>3.1</b> Fungsi Skalar vs Agregat</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="perhitungan-statistik-dasar.html"><a href="perhitungan-statistik-dasar.html#perhitungan-skalar"><i class="fa fa-check"></i><b>3.1.1</b> Perhitungan Skalar</a></li>
<li class="chapter" data-level="3.1.2" data-path="perhitungan-statistik-dasar.html"><a href="perhitungan-statistik-dasar.html#perhitungan-agregat"><i class="fa fa-check"></i><b>3.1.2</b> Perhitungan Agregat</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="perhitungan-statistik-dasar.html"><a href="perhitungan-statistik-dasar.html#perhitungan-group-by"><i class="fa fa-check"></i><b>3.2</b> Perhitungan <code>GROUP BY</code></a></li>
<li class="chapter" data-level="3.3" data-path="perhitungan-statistik-dasar.html"><a href="perhitungan-statistik-dasar.html#perhitungan-having"><i class="fa fa-check"></i><b>3.3</b> Perhitungan <code>HAVING</code></a></li>
<li class="chapter" data-level="3.4" data-path="perhitungan-statistik-dasar.html"><a href="perhitungan-statistik-dasar.html#perhitungan-case-when"><i class="fa fa-check"></i><b>3.4</b> Perhitungan <code>CASE WHEN</code></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="perhitungan-statistik-dasar.html"><a href="perhitungan-statistik-dasar.html#buat-struktur-tabel"><i class="fa fa-check"></i><b>3.4.1</b> Buat Struktur Tabel</a></li>
<li class="chapter" data-level="3.4.2" data-path="perhitungan-statistik-dasar.html"><a href="perhitungan-statistik-dasar.html#insert-data"><i class="fa fa-check"></i><b>3.4.2</b> Insert Data</a></li>
<li class="chapter" data-level="3.4.3" data-path="perhitungan-statistik-dasar.html"><a href="perhitungan-statistik-dasar.html#lihat-data-tabel"><i class="fa fa-check"></i><b>3.4.3</b> Lihat Data Tabel</a></li>
<li class="chapter" data-level="3.4.4" data-path="perhitungan-statistik-dasar.html"><a href="perhitungan-statistik-dasar.html#perhitungan-case"><i class="fa fa-check"></i><b>3.4.4</b> Perhitungan <code>CASE</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="perhitungan-statistik-dasar.html"><a href="perhitungan-statistik-dasar.html#tugas-kelompok-selesai-duluan-c-a-b"><i class="fa fa-check"></i><b>3.5</b> Tugas Kelompok (Selesai duluan C, A, B)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html"><i class="fa fa-check"></i><b>4</b> Join Tabel &amp; Subkueri</a>
<ul>
<li class="chapter" data-level="4.1" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#pendahuluan-1"><i class="fa fa-check"></i><b>4.1</b> Pendahuluan</a></li>
<li class="chapter" data-level="4.2" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#create-database-baru"><i class="fa fa-check"></i><b>4.2</b> CREATE Database Baru</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#create-tabel"><i class="fa fa-check"></i><b>4.2.1</b> CREATE Tabel</a></li>
<li class="chapter" data-level="4.2.2" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#insert-data-tabel"><i class="fa fa-check"></i><b>4.2.2</b> INSERT Data Tabel</a></li>
<li class="chapter" data-level="4.2.3" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#read-tabel"><i class="fa fa-check"></i><b>4.2.3</b> READ Tabel</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#join-tabel"><i class="fa fa-check"></i><b>4.3</b> Join Tabel</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#inner-join"><i class="fa fa-check"></i><b>4.3.1</b> INNER JOIN</a></li>
<li class="chapter" data-level="4.3.2" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#left-join"><i class="fa fa-check"></i><b>4.3.2</b> LEFT JOIN</a></li>
<li class="chapter" data-level="4.3.3" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#left-join-partial"><i class="fa fa-check"></i><b>4.3.3</b> LEFT JOIN (Partial)</a></li>
<li class="chapter" data-level="4.3.4" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#right-join"><i class="fa fa-check"></i><b>4.3.4</b> RIGHT JOIN</a></li>
<li class="chapter" data-level="4.3.5" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#full-join"><i class="fa fa-check"></i><b>4.3.5</b> FULL JOIN</a></li>
<li class="chapter" data-level="4.3.6" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#implisit-join-tabel"><i class="fa fa-check"></i><b>4.3.6</b> Implisit Join Tabel</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#studi-kasus"><i class="fa fa-check"></i><b>4.4</b> Studi Kasus</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#soal-1"><i class="fa fa-check"></i><b>4.4.1</b> Soal 1</a></li>
<li class="chapter" data-level="4.4.2" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#soal-2"><i class="fa fa-check"></i><b>4.4.2</b> Soal 2</a></li>
<li class="chapter" data-level="4.4.3" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#soal-3"><i class="fa fa-check"></i><b>4.4.3</b> Soal 3</a></li>
<li class="chapter" data-level="4.4.4" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#soal-4"><i class="fa fa-check"></i><b>4.4.4</b> Soal 4</a></li>
<li class="chapter" data-level="4.4.5" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#soal-5"><i class="fa fa-check"></i><b>4.4.5</b> Soal 5</a></li>
<li class="chapter" data-level="4.4.6" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#soal-6"><i class="fa fa-check"></i><b>4.4.6</b> Soal 6</a></li>
<li class="chapter" data-level="4.4.7" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#soal-7"><i class="fa fa-check"></i><b>4.4.7</b> Soal 7</a></li>
<li class="chapter" data-level="4.4.8" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#soal-8"><i class="fa fa-check"></i><b>4.4.8</b> Soal 8</a></li>
<li class="chapter" data-level="4.4.9" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#soal-9"><i class="fa fa-check"></i><b>4.4.9</b> Soal 9</a></li>
<li class="chapter" data-level="4.4.10" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#soal-10"><i class="fa fa-check"></i><b>4.4.10</b> Soal 10</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="join-tabel-subkueri.html"><a href="join-tabel-subkueri.html#referensi"><i class="fa fa-check"></i>Referensi</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="w1h-visualisasi.html"><a href="w1h-visualisasi.html"><i class="fa fa-check"></i><b>5</b> 5W1H &amp; Visualisasi</a></li>
<li class="chapter" data-level="6" data-path="persentasi-tugas-akhir.html"><a href="persentasi-tugas-akhir.html"><i class="fa fa-check"></i><b>6</b> Persentasi Tugas Akhir</a></li>
<li class="chapter" data-level="7" data-path="penutup.html"><a href="penutup.html"><i class="fa fa-check"></i><b>7</b> Penutup</a></li>
<li><a href="section.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="daftar-pustaka.html"><a href="daftar-pustaka.html"><i class="fa fa-check"></i>Daftar Pustaka</a></li>
<li class="divider"></li>
<li><a href="https://github.com/dsciencelabs/JNE_Data_Analytics_PySQL.git" target="blank">Published with Bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">WORKSHOP</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="join-tabel-subkueri" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Bab 4</span> Join Tabel &amp; Subkueri<a href="join-tabel-subkueri.html#join-tabel-subkueri" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="pendahuluan-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Pendahuluan<a href="join-tabel-subkueri.html#pendahuluan-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pada bagian pendahuluan ini kita akan membahas query untuk menampilkan data dari beberapa tabel MySQL. Karena sering kali mengambil data dari database yang disimpan di beberapa tabel untuk diolah sehingga menjadi satu keluaran. Kita menggunakan empat tabel, yaitu: tabel pelanggan, produk, transaksi, dan transaksi_detail. Struktur dan hubungan keempat tabel tersebut tampak seperti pada gambar berikut:</p>
<p><img align="middle" src="images/bab4/Hubungan-Antar-Tabel.png"  width = 100% /></p>
</div>
<div id="create-database-baru" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> CREATE Database Baru<a href="join-tabel-subkueri.html#create-database-baru" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pertama-tama kita buat database baru untuk menyimpan menyimpan tabel seperti dipelihatkan diatas, sebagai berikut:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="join-tabel-subkueri.html#cb31-1" tabindex="-1"></a><span class="co"># import module </span></span>
<span id="cb31-2"><a href="join-tabel-subkueri.html#cb31-2" tabindex="-1"></a><span class="im">import</span> mysql.connector</span>
<span id="cb31-3"><a href="join-tabel-subkueri.html#cb31-3" tabindex="-1"></a></span>
<span id="cb31-4"><a href="join-tabel-subkueri.html#cb31-4" tabindex="-1"></a><span class="co"># koneksi server</span></span>
<span id="cb31-5"><a href="join-tabel-subkueri.html#cb31-5" tabindex="-1"></a>db1 <span class="op">=</span> mysql.connector.<span class="ex">connect</span>(</span>
<span id="cb31-6"><a href="join-tabel-subkueri.html#cb31-6" tabindex="-1"></a>  host<span class="op">=</span><span class="st">&#39;localhost&#39;</span>,</span>
<span id="cb31-7"><a href="join-tabel-subkueri.html#cb31-7" tabindex="-1"></a>  user<span class="op">=</span><span class="st">&#39;bakti&#39;</span>,</span>
<span id="cb31-8"><a href="join-tabel-subkueri.html#cb31-8" tabindex="-1"></a>  passwd<span class="op">=</span><span class="st">&#39;123&#39;</span></span>
<span id="cb31-9"><a href="join-tabel-subkueri.html#cb31-9" tabindex="-1"></a>)</span>
<span id="cb31-10"><a href="join-tabel-subkueri.html#cb31-10" tabindex="-1"></a></span>
<span id="cb31-11"><a href="join-tabel-subkueri.html#cb31-11" tabindex="-1"></a><span class="co"># membuat objek &#39;cursor` sebagai kata kunci eksekusi SQL</span></span>
<span id="cb31-12"><a href="join-tabel-subkueri.html#cb31-12" tabindex="-1"></a>cursor1 <span class="op">=</span> db1.cursor()</span>
<span id="cb31-13"><a href="join-tabel-subkueri.html#cb31-13" tabindex="-1"></a></span>
<span id="cb31-14"><a href="join-tabel-subkueri.html#cb31-14" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb31-15"><a href="join-tabel-subkueri.html#cb31-15" tabindex="-1"></a>sql<span class="op">=</span><span class="st">&#39;&#39;&#39;CREATE DATABASE IF NOT EXISTS join_tabel&#39;&#39;&#39;</span></span>
<span id="cb31-16"><a href="join-tabel-subkueri.html#cb31-16" tabindex="-1"></a></span>
<span id="cb31-17"><a href="join-tabel-subkueri.html#cb31-17" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb31-18"><a href="join-tabel-subkueri.html#cb31-18" tabindex="-1"></a>cursor1.execute(sql)</span></code></pre></div>
<p>Untuk memastikan koneksi sudah berhasil, berikut ini coba check database yang sudah tersimpan di server lokal anda.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="join-tabel-subkueri.html#cb32-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb32-2"><a href="join-tabel-subkueri.html#cb32-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;SHOW DATABASES&#39;</span></span>
<span id="cb32-3"><a href="join-tabel-subkueri.html#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="join-tabel-subkueri.html#cb32-4" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb32-5"><a href="join-tabel-subkueri.html#cb32-5" tabindex="-1"></a>cursor1.execute(sql)</span>
<span id="cb32-6"><a href="join-tabel-subkueri.html#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="join-tabel-subkueri.html#cb32-7" tabindex="-1"></a><span class="co"># menampilkan daftar database</span></span>
<span id="cb32-8"><a href="join-tabel-subkueri.html#cb32-8" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> cursor1:</span>
<span id="cb32-9"><a href="join-tabel-subkueri.html#cb32-9" tabindex="-1"></a>  <span class="bu">print</span>(x) </span></code></pre></div>
<div id="create-tabel" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> CREATE Tabel<a href="join-tabel-subkueri.html#create-tabel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sintaks berikut ini adalah untuk membangun ke-empat tabel yang kan kita gunakan. Pertama-tama kita buatkan koneksi dan kursor baru sebagai berikut:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="join-tabel-subkueri.html#cb33-1" tabindex="-1"></a><span class="co"># import module </span></span>
<span id="cb33-2"><a href="join-tabel-subkueri.html#cb33-2" tabindex="-1"></a><span class="im">import</span> mysql.connector</span>
<span id="cb33-3"><a href="join-tabel-subkueri.html#cb33-3" tabindex="-1"></a></span>
<span id="cb33-4"><a href="join-tabel-subkueri.html#cb33-4" tabindex="-1"></a><span class="co"># koneksi server</span></span>
<span id="cb33-5"><a href="join-tabel-subkueri.html#cb33-5" tabindex="-1"></a>db2 <span class="op">=</span> mysql.connector.<span class="ex">connect</span>(</span>
<span id="cb33-6"><a href="join-tabel-subkueri.html#cb33-6" tabindex="-1"></a>  host<span class="op">=</span><span class="st">&#39;localhost&#39;</span>,</span>
<span id="cb33-7"><a href="join-tabel-subkueri.html#cb33-7" tabindex="-1"></a>  user<span class="op">=</span><span class="st">&#39;bakti&#39;</span>,</span>
<span id="cb33-8"><a href="join-tabel-subkueri.html#cb33-8" tabindex="-1"></a>  passwd<span class="op">=</span><span class="st">&#39;123&#39;</span>,</span>
<span id="cb33-9"><a href="join-tabel-subkueri.html#cb33-9" tabindex="-1"></a>  database<span class="op">=</span><span class="st">&#39;join_tabel&#39;</span></span>
<span id="cb33-10"><a href="join-tabel-subkueri.html#cb33-10" tabindex="-1"></a>)</span>
<span id="cb33-11"><a href="join-tabel-subkueri.html#cb33-11" tabindex="-1"></a></span>
<span id="cb33-12"><a href="join-tabel-subkueri.html#cb33-12" tabindex="-1"></a><span class="co"># membuat objek &#39;cursor` sebagai kata kunci eksekusi SQL</span></span>
<span id="cb33-13"><a href="join-tabel-subkueri.html#cb33-13" tabindex="-1"></a>cursor2 <span class="op">=</span> db2.cursor()</span></code></pre></div>
<p>Setelah koneksi dan kursor baru berhasil dibuatkan, berikutnya kita buatkan struktur tabel yang diperlukan;</p>
<div id="struktur-tabel-barang" class="section level4 unnumbered hasAnchor">
<h4>Struktur Tabel Barang<a href="join-tabel-subkueri.html#struktur-tabel-barang" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="join-tabel-subkueri.html#cb34-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb34-2"><a href="join-tabel-subkueri.html#cb34-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39;</span></span>
<span id="cb34-3"><a href="join-tabel-subkueri.html#cb34-3" tabindex="-1"></a><span class="st">CREATE TABLE IF NOT EXISTS `barang` (</span></span>
<span id="cb34-4"><a href="join-tabel-subkueri.html#cb34-4" tabindex="-1"></a><span class="st">  `id_barang` int(11) NOT NULL AUTO_INCREMENT,</span></span>
<span id="cb34-5"><a href="join-tabel-subkueri.html#cb34-5" tabindex="-1"></a><span class="st">  `id_kategori` smallint(6) NOT NULL,</span></span>
<span id="cb34-6"><a href="join-tabel-subkueri.html#cb34-6" tabindex="-1"></a><span class="st">  `nama_barang` varchar(255) CHARACTER SET latin1 NOT NULL,</span></span>
<span id="cb34-7"><a href="join-tabel-subkueri.html#cb34-7" tabindex="-1"></a><span class="st">  `harga` int(11) NOT NULL,</span></span>
<span id="cb34-8"><a href="join-tabel-subkueri.html#cb34-8" tabindex="-1"></a><span class="st">  `stok` int(11) NOT NULL,</span></span>
<span id="cb34-9"><a href="join-tabel-subkueri.html#cb34-9" tabindex="-1"></a><span class="st">  PRIMARY KEY (`id_barang`)</span></span>
<span id="cb34-10"><a href="join-tabel-subkueri.html#cb34-10" tabindex="-1"></a><span class="st">); </span></span>
<span id="cb34-11"><a href="join-tabel-subkueri.html#cb34-11" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb34-12"><a href="join-tabel-subkueri.html#cb34-12" tabindex="-1"></a></span>
<span id="cb34-13"><a href="join-tabel-subkueri.html#cb34-13" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb34-14"><a href="join-tabel-subkueri.html#cb34-14" tabindex="-1"></a>cursor2.execute(sql)</span>
<span id="cb34-15"><a href="join-tabel-subkueri.html#cb34-15" tabindex="-1"></a></span>
<span id="cb34-16"><a href="join-tabel-subkueri.html#cb34-16" tabindex="-1"></a><span class="co"># Simpan perubahan</span></span>
<span id="cb34-17"><a href="join-tabel-subkueri.html#cb34-17" tabindex="-1"></a>db2.commit()</span></code></pre></div>
</div>
<div id="struktur-tabel-pelanggan" class="section level4 unnumbered hasAnchor">
<h4>Struktur Tabel Pelanggan<a href="join-tabel-subkueri.html#struktur-tabel-pelanggan" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="join-tabel-subkueri.html#cb35-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb35-2"><a href="join-tabel-subkueri.html#cb35-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb35-3"><a href="join-tabel-subkueri.html#cb35-3" tabindex="-1"></a><span class="st">CREATE TABLE IF NOT EXISTS `pelanggan` (</span></span>
<span id="cb35-4"><a href="join-tabel-subkueri.html#cb35-4" tabindex="-1"></a><span class="st">  `id_pelanggan` int(11) NOT NULL AUTO_INCREMENT,</span></span>
<span id="cb35-5"><a href="join-tabel-subkueri.html#cb35-5" tabindex="-1"></a><span class="st">  `nama` varchar(50) DEFAULT NULL,</span></span>
<span id="cb35-6"><a href="join-tabel-subkueri.html#cb35-6" tabindex="-1"></a><span class="st">  `email` varchar(50) DEFAULT NULL,</span></span>
<span id="cb35-7"><a href="join-tabel-subkueri.html#cb35-7" tabindex="-1"></a><span class="st">  PRIMARY KEY (`id_pelanggan`) </span></span>
<span id="cb35-8"><a href="join-tabel-subkueri.html#cb35-8" tabindex="-1"></a><span class="st">); </span></span>
<span id="cb35-9"><a href="join-tabel-subkueri.html#cb35-9" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb35-10"><a href="join-tabel-subkueri.html#cb35-10" tabindex="-1"></a></span>
<span id="cb35-11"><a href="join-tabel-subkueri.html#cb35-11" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb35-12"><a href="join-tabel-subkueri.html#cb35-12" tabindex="-1"></a>cursor2.execute(sql)</span>
<span id="cb35-13"><a href="join-tabel-subkueri.html#cb35-13" tabindex="-1"></a></span>
<span id="cb35-14"><a href="join-tabel-subkueri.html#cb35-14" tabindex="-1"></a><span class="co"># Simpan perubahan</span></span>
<span id="cb35-15"><a href="join-tabel-subkueri.html#cb35-15" tabindex="-1"></a>db2.commit()</span></code></pre></div>
</div>
<div id="struktur-tabel-penjualan" class="section level4 unnumbered hasAnchor">
<h4>Struktur Tabel Penjualan<a href="join-tabel-subkueri.html#struktur-tabel-penjualan" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="join-tabel-subkueri.html#cb36-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb36-2"><a href="join-tabel-subkueri.html#cb36-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb36-3"><a href="join-tabel-subkueri.html#cb36-3" tabindex="-1"></a><span class="st">CREATE TABLE IF NOT EXISTS `penjualan` (</span></span>
<span id="cb36-4"><a href="join-tabel-subkueri.html#cb36-4" tabindex="-1"></a><span class="st">  `id_transaksi` int(11) NOT NULL AUTO_INCREMENT,</span></span>
<span id="cb36-5"><a href="join-tabel-subkueri.html#cb36-5" tabindex="-1"></a><span class="st">  `id_pelanggan` int(11) DEFAULT NULL,</span></span>
<span id="cb36-6"><a href="join-tabel-subkueri.html#cb36-6" tabindex="-1"></a><span class="st">  `tgl_transaksi` date NOT NULL,</span></span>
<span id="cb36-7"><a href="join-tabel-subkueri.html#cb36-7" tabindex="-1"></a><span class="st">  `total_transaksi` int(11) NOT NULL,</span></span>
<span id="cb36-8"><a href="join-tabel-subkueri.html#cb36-8" tabindex="-1"></a><span class="st">  PRIMARY KEY (`id_transaksi`),</span></span>
<span id="cb36-9"><a href="join-tabel-subkueri.html#cb36-9" tabindex="-1"></a><span class="st">  KEY `FK_penjualan_pelanggan` (`id_pelanggan`),</span></span>
<span id="cb36-10"><a href="join-tabel-subkueri.html#cb36-10" tabindex="-1"></a><span class="st">  CONSTRAINT `FK_penjualan_pelanggan` FOREIGN KEY (`id_pelanggan`) REFERENCES `pelanggan` (`id_pelanggan`) ON DELETE SET NULL ON UPDATE CASCADE</span></span>
<span id="cb36-11"><a href="join-tabel-subkueri.html#cb36-11" tabindex="-1"></a><span class="st">); </span></span>
<span id="cb36-12"><a href="join-tabel-subkueri.html#cb36-12" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb36-13"><a href="join-tabel-subkueri.html#cb36-13" tabindex="-1"></a></span>
<span id="cb36-14"><a href="join-tabel-subkueri.html#cb36-14" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb36-15"><a href="join-tabel-subkueri.html#cb36-15" tabindex="-1"></a>cursor2.execute(sql)</span>
<span id="cb36-16"><a href="join-tabel-subkueri.html#cb36-16" tabindex="-1"></a></span>
<span id="cb36-17"><a href="join-tabel-subkueri.html#cb36-17" tabindex="-1"></a><span class="co"># Simpan perubahan</span></span>
<span id="cb36-18"><a href="join-tabel-subkueri.html#cb36-18" tabindex="-1"></a>db2.commit()</span></code></pre></div>
</div>
<div id="struktur-tabel-detail-penjualan" class="section level4 unnumbered hasAnchor">
<h4>Struktur Tabel Detail Penjualan<a href="join-tabel-subkueri.html#struktur-tabel-detail-penjualan" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="join-tabel-subkueri.html#cb37-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb37-2"><a href="join-tabel-subkueri.html#cb37-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb37-3"><a href="join-tabel-subkueri.html#cb37-3" tabindex="-1"></a><span class="st">CREATE TABLE IF NOT EXISTS `penjualan_detail` (</span></span>
<span id="cb37-4"><a href="join-tabel-subkueri.html#cb37-4" tabindex="-1"></a><span class="st">  `id_transaksi_detail` int(11) NOT NULL AUTO_INCREMENT,</span></span>
<span id="cb37-5"><a href="join-tabel-subkueri.html#cb37-5" tabindex="-1"></a><span class="st">  `id_transaksi` int(11) DEFAULT NULL,</span></span>
<span id="cb37-6"><a href="join-tabel-subkueri.html#cb37-6" tabindex="-1"></a><span class="st">  `id_barang` int(11) DEFAULT NULL,</span></span>
<span id="cb37-7"><a href="join-tabel-subkueri.html#cb37-7" tabindex="-1"></a><span class="st">  `jml_barang` smallint(6) DEFAULT NULL,</span></span>
<span id="cb37-8"><a href="join-tabel-subkueri.html#cb37-8" tabindex="-1"></a><span class="st">  `harga_satuan` int(11) DEFAULT NULL,</span></span>
<span id="cb37-9"><a href="join-tabel-subkueri.html#cb37-9" tabindex="-1"></a><span class="st">  PRIMARY KEY (`id_transaksi_detail`),</span></span>
<span id="cb37-10"><a href="join-tabel-subkueri.html#cb37-10" tabindex="-1"></a><span class="st">  KEY `FK_tb_penjualan_detail_tb_barang` (`id_barang`),</span></span>
<span id="cb37-11"><a href="join-tabel-subkueri.html#cb37-11" tabindex="-1"></a><span class="st">  KEY `FK_tb_penjualan_detail_tb_penjualan` (`id_transaksi`),</span></span>
<span id="cb37-12"><a href="join-tabel-subkueri.html#cb37-12" tabindex="-1"></a><span class="st">  CONSTRAINT `FK_tb_penjualan_detail_tb_barang` FOREIGN KEY (`id_barang`) REFERENCES `barang` (`id_barang`) ON DELETE CASCADE ON UPDATE CASCADE,</span></span>
<span id="cb37-13"><a href="join-tabel-subkueri.html#cb37-13" tabindex="-1"></a><span class="st">  CONSTRAINT `FK_tb_penjualan_detail_tb_penjualan` FOREIGN KEY (`id_transaksi`) REFERENCES `penjualan` (`id_transaksi`) ON DELETE CASCADE ON UPDATE CASCADE</span></span>
<span id="cb37-14"><a href="join-tabel-subkueri.html#cb37-14" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb37-15"><a href="join-tabel-subkueri.html#cb37-15" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb37-16"><a href="join-tabel-subkueri.html#cb37-16" tabindex="-1"></a></span>
<span id="cb37-17"><a href="join-tabel-subkueri.html#cb37-17" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb37-18"><a href="join-tabel-subkueri.html#cb37-18" tabindex="-1"></a>cursor2.execute(sql)</span>
<span id="cb37-19"><a href="join-tabel-subkueri.html#cb37-19" tabindex="-1"></a></span>
<span id="cb37-20"><a href="join-tabel-subkueri.html#cb37-20" tabindex="-1"></a><span class="co"># Simpan perubahan</span></span>
<span id="cb37-21"><a href="join-tabel-subkueri.html#cb37-21" tabindex="-1"></a>db2.commit()</span></code></pre></div>
<p><strong>Catatan: </strong> <a href="http://nyunyunbee.blogspot.com/2013/06/pengertian-cascade-dalam-mysql.html">Pengertian Cascade dalam MySql</a></p>
<p><strong>Keterangan</strong>:</p>
<p>Pengaturan Struktur Tabel SQL digunakan untuk menentukan aturan struktur data dalam tabel. Batasan digunakan untuk membatasi jenis data yang dapat masuk ke dalam tabel, memastikan keakuratan dan keandalan data dalam tabel. Batasan dapat berupa tingkat kolom atau tingkat tabel. Batasan tingkat kolom berlaku untuk kolom, dan batasan tingkat tabel berlaku untuk keseluruhan tabel. Berikut Batasan yang biasanya digunakan dalam SQL:</p>
<ul>
<li><em>NOT NULL:</em> Memastikan kolom tidak boleh memiliki nilai NULL</li>
<li><em>UNIQUE:</em> Memastikan bahwa semua nilai dalam kolom berbeda</li>
<li><em>PRIMARY KEY:</em> Kombinasi NOT NULL dan UNIQUE. Secara unik mengidentifikasi setiap baris dalam tabel</li>
<li><em>FOREIGN KEY:</em> Secara unik mengidentifikasi baris/record di tabel lain</li>
<li><em>CHECK:</em> Memastikan bahwa semua nilai dalam kolom memenuhi kondisi tertentu</li>
<li><em>DEFAULT:</em> Menetapkan nilai default untuk kolom saat tidak ada nilai yang ditentukan</li>
<li><em>INDEX:</em> Digunakan untuk membuat dan mengambil data dari database dengan sangat cepat</li>
<li><em>AUTO_INCREMENT:</em> memungkinkan inset data unik pada kolom tertentu yang dihasilkan secara otomatis saat data baru dimasukkan ke dalam tabel. Seringkali kolom ini adalah adalah juga <em>PRIMARY KEY</em> dan ingin dibuat secara otomatis setiap kali catatan baru dimasukkan.</li>
</ul>
</div>
</div>
<div id="insert-data-tabel" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> INSERT Data Tabel<a href="join-tabel-subkueri.html#insert-data-tabel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Berikut ini adalah koding yang digunakan untuk menambahkan data ke dalam tabel;</p>
<div id="insert-data-barang" class="section level4 unnumbered hasAnchor">
<h4>Insert Data Barang<a href="join-tabel-subkueri.html#insert-data-barang" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="join-tabel-subkueri.html#cb38-1" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39;</span></span>
<span id="cb38-2"><a href="join-tabel-subkueri.html#cb38-2" tabindex="-1"></a><span class="st">INSERT INTO `barang` (`id_barang`, `id_kategori`, `nama_barang`, `harga`, `stok`) </span></span>
<span id="cb38-3"><a href="join-tabel-subkueri.html#cb38-3" tabindex="-1"></a><span class="st">      VALUES (</span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">)&#39;&#39;&#39;</span></span>
<span id="cb38-4"><a href="join-tabel-subkueri.html#cb38-4" tabindex="-1"></a>      </span>
<span id="cb38-5"><a href="join-tabel-subkueri.html#cb38-5" tabindex="-1"></a>values <span class="op">=</span> [(<span class="dv">1</span>, <span class="dv">1</span>, <span class="st">&#39;RAM&#39;</span>, <span class="dv">230000</span>, <span class="dv">4</span>),</span>
<span id="cb38-6"><a href="join-tabel-subkueri.html#cb38-6" tabindex="-1"></a>            (<span class="dv">2</span>, <span class="dv">1</span>, <span class="st">&#39;Mainboard&#39;</span>, <span class="dv">1250000</span>, <span class="dv">7</span>),</span>
<span id="cb38-7"><a href="join-tabel-subkueri.html#cb38-7" tabindex="-1"></a>            (<span class="dv">3</span>, <span class="dv">1</span>, <span class="st">&#39;Mouse&#39;</span>, <span class="dv">80000</span>, <span class="dv">6</span>),</span>
<span id="cb38-8"><a href="join-tabel-subkueri.html#cb38-8" tabindex="-1"></a>            (<span class="dv">4</span>, <span class="dv">3</span>, <span class="st">&#39;Mousepad&#39;</span>, <span class="dv">35000</span>, <span class="dv">3</span>),</span>
<span id="cb38-9"><a href="join-tabel-subkueri.html#cb38-9" tabindex="-1"></a>            (<span class="dv">5</span>, <span class="dv">3</span>, <span class="st">&#39;Keyboard&#39;</span>, <span class="dv">80000</span>, <span class="dv">5</span>)</span>
<span id="cb38-10"><a href="join-tabel-subkueri.html#cb38-10" tabindex="-1"></a>         ]</span>
<span id="cb38-11"><a href="join-tabel-subkueri.html#cb38-11" tabindex="-1"></a>         </span>
<span id="cb38-12"><a href="join-tabel-subkueri.html#cb38-12" tabindex="-1"></a><span class="cf">for</span> val <span class="kw">in</span> values:</span>
<span id="cb38-13"><a href="join-tabel-subkueri.html#cb38-13" tabindex="-1"></a>  cursor2.execute(sql, val)</span>
<span id="cb38-14"><a href="join-tabel-subkueri.html#cb38-14" tabindex="-1"></a>  db2.commit()</span></code></pre></div>
</div>
<div id="insert-data-pelanggan" class="section level4 unnumbered hasAnchor">
<h4>Insert Data Pelanggan<a href="join-tabel-subkueri.html#insert-data-pelanggan" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="join-tabel-subkueri.html#cb39-1" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39;</span></span>
<span id="cb39-2"><a href="join-tabel-subkueri.html#cb39-2" tabindex="-1"></a><span class="st">INSERT INTO `pelanggan` (`id_pelanggan`, `nama`, `email`)</span></span>
<span id="cb39-3"><a href="join-tabel-subkueri.html#cb39-3" tabindex="-1"></a><span class="st">      VALUES (</span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">)&#39;&#39;&#39;</span></span>
<span id="cb39-4"><a href="join-tabel-subkueri.html#cb39-4" tabindex="-1"></a>      </span>
<span id="cb39-5"><a href="join-tabel-subkueri.html#cb39-5" tabindex="-1"></a>values <span class="op">=</span> [(<span class="dv">1</span>, <span class="st">&#39;Alfa&#39;</span>, <span class="st">&#39;alfa@yahoo.com&#39;</span>),</span>
<span id="cb39-6"><a href="join-tabel-subkueri.html#cb39-6" tabindex="-1"></a>            (<span class="dv">2</span>, <span class="st">&#39;Beta&#39;</span>, <span class="st">&#39;beta@gmail.com&#39;</span>),</span>
<span id="cb39-7"><a href="join-tabel-subkueri.html#cb39-7" tabindex="-1"></a>            (<span class="dv">3</span>, <span class="st">&#39;Delta&#39;</span>, <span class="st">&#39;delta@hotmail.com&#39;</span>),</span>
<span id="cb39-8"><a href="join-tabel-subkueri.html#cb39-8" tabindex="-1"></a>            (<span class="dv">4</span>, <span class="st">&#39;Bakti&#39;</span>, <span class="st">&#39;dsciencelabs@outlook.com&#39;</span>)</span>
<span id="cb39-9"><a href="join-tabel-subkueri.html#cb39-9" tabindex="-1"></a>           ]</span>
<span id="cb39-10"><a href="join-tabel-subkueri.html#cb39-10" tabindex="-1"></a>         </span>
<span id="cb39-11"><a href="join-tabel-subkueri.html#cb39-11" tabindex="-1"></a><span class="cf">for</span> val <span class="kw">in</span> values:</span>
<span id="cb39-12"><a href="join-tabel-subkueri.html#cb39-12" tabindex="-1"></a>  cursor2.execute(sql, val)</span>
<span id="cb39-13"><a href="join-tabel-subkueri.html#cb39-13" tabindex="-1"></a>  db2.commit()</span></code></pre></div>
</div>
<div id="insert-data-penjualan" class="section level4 unnumbered hasAnchor">
<h4>Insert Data Penjualan<a href="join-tabel-subkueri.html#insert-data-penjualan" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="join-tabel-subkueri.html#cb40-1" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39;</span></span>
<span id="cb40-2"><a href="join-tabel-subkueri.html#cb40-2" tabindex="-1"></a><span class="st">INSERT INTO `penjualan` (`id_transaksi`, `id_pelanggan`, `tgl_transaksi`, `total_transaksi`)</span></span>
<span id="cb40-3"><a href="join-tabel-subkueri.html#cb40-3" tabindex="-1"></a><span class="st">      VALUES (</span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">)&#39;&#39;&#39;</span></span>
<span id="cb40-4"><a href="join-tabel-subkueri.html#cb40-4" tabindex="-1"></a>      </span>
<span id="cb40-5"><a href="join-tabel-subkueri.html#cb40-5" tabindex="-1"></a>values <span class="op">=</span> [(<span class="dv">1</span>, <span class="dv">1</span>, <span class="st">&#39;2023-06-22&#39;</span>, <span class="dv">230000</span>),</span>
<span id="cb40-6"><a href="join-tabel-subkueri.html#cb40-6" tabindex="-1"></a>            (<span class="dv">2</span>, <span class="dv">3</span>, <span class="st">&#39;2023-06-22&#39;</span>, <span class="dv">195000</span>),</span>
<span id="cb40-7"><a href="join-tabel-subkueri.html#cb40-7" tabindex="-1"></a>            (<span class="dv">3</span>, <span class="dv">2</span>, <span class="st">&#39;2023-05-01&#39;</span>, <span class="dv">1710000</span>),</span>
<span id="cb40-8"><a href="join-tabel-subkueri.html#cb40-8" tabindex="-1"></a>            (<span class="dv">4</span>, <span class="dv">1</span>, <span class="st">&#39;2023-07-04&#39;</span>, <span class="dv">310000</span>),</span>
<span id="cb40-9"><a href="join-tabel-subkueri.html#cb40-9" tabindex="-1"></a>            (<span class="dv">5</span>, <span class="dv">3</span>, <span class="st">&#39;2023-07-10&#39;</span>, <span class="dv">80000</span>)</span>
<span id="cb40-10"><a href="join-tabel-subkueri.html#cb40-10" tabindex="-1"></a>           ]</span>
<span id="cb40-11"><a href="join-tabel-subkueri.html#cb40-11" tabindex="-1"></a>         </span>
<span id="cb40-12"><a href="join-tabel-subkueri.html#cb40-12" tabindex="-1"></a><span class="cf">for</span> val <span class="kw">in</span> values:</span>
<span id="cb40-13"><a href="join-tabel-subkueri.html#cb40-13" tabindex="-1"></a>  cursor2.execute(sql, val)</span>
<span id="cb40-14"><a href="join-tabel-subkueri.html#cb40-14" tabindex="-1"></a>  db2.commit()</span></code></pre></div>
</div>
<div id="insert-data-penjulan-detail" class="section level4 unnumbered hasAnchor">
<h4>Insert Data Penjulan Detail<a href="join-tabel-subkueri.html#insert-data-penjulan-detail" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="join-tabel-subkueri.html#cb41-1" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39;</span></span>
<span id="cb41-2"><a href="join-tabel-subkueri.html#cb41-2" tabindex="-1"></a><span class="st">INSERT INTO `penjualan_detail` (`id_transaksi_detail`, `id_transaksi`, `id_barang`, `jml_barang`, `harga_satuan`)</span></span>
<span id="cb41-3"><a href="join-tabel-subkueri.html#cb41-3" tabindex="-1"></a><span class="st">      VALUES (</span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">, </span><span class="sc">%s</span><span class="st">); </span></span>
<span id="cb41-4"><a href="join-tabel-subkueri.html#cb41-4" tabindex="-1"></a><span class="st">      &#39;&#39;&#39;</span></span>
<span id="cb41-5"><a href="join-tabel-subkueri.html#cb41-5" tabindex="-1"></a>values <span class="op">=</span> [(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">230000</span>),</span>
<span id="cb41-6"><a href="join-tabel-subkueri.html#cb41-6" tabindex="-1"></a>            (<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">35000</span>),</span>
<span id="cb41-7"><a href="join-tabel-subkueri.html#cb41-7" tabindex="-1"></a>            (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">80000</span>),</span>
<span id="cb41-8"><a href="join-tabel-subkueri.html#cb41-8" tabindex="-1"></a>            (<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1250000</span>),</span>
<span id="cb41-9"><a href="join-tabel-subkueri.html#cb41-9" tabindex="-1"></a>            (<span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">230000</span>),</span>
<span id="cb41-10"><a href="join-tabel-subkueri.html#cb41-10" tabindex="-1"></a>            (<span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">35000</span>),</span>
<span id="cb41-11"><a href="join-tabel-subkueri.html#cb41-11" tabindex="-1"></a>            (<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">80000</span>),</span>
<span id="cb41-12"><a href="join-tabel-subkueri.html#cb41-12" tabindex="-1"></a>            (<span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">80000</span>),</span>
<span id="cb41-13"><a href="join-tabel-subkueri.html#cb41-13" tabindex="-1"></a>            (<span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">80000</span>)</span>
<span id="cb41-14"><a href="join-tabel-subkueri.html#cb41-14" tabindex="-1"></a>           ]</span>
<span id="cb41-15"><a href="join-tabel-subkueri.html#cb41-15" tabindex="-1"></a>         </span>
<span id="cb41-16"><a href="join-tabel-subkueri.html#cb41-16" tabindex="-1"></a><span class="cf">for</span> val <span class="kw">in</span> values:</span>
<span id="cb41-17"><a href="join-tabel-subkueri.html#cb41-17" tabindex="-1"></a>  cursor2.execute(sql, val)</span>
<span id="cb41-18"><a href="join-tabel-subkueri.html#cb41-18" tabindex="-1"></a>  db2.commit()</span></code></pre></div>
</div>
</div>
<div id="read-tabel" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> READ Tabel<a href="join-tabel-subkueri.html#read-tabel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Membaca data tabel SQL dengan Python diperlukan koneksi dan engine yang aktif untuk memuat data yang diperlihatkan ke pengguna. Berikut ini adalah langkah pembentukan koneksi dan enginya.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="join-tabel-subkueri.html#cb42-1" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine</span>
<span id="cb42-2"><a href="join-tabel-subkueri.html#cb42-2" tabindex="-1"></a><span class="im">import</span> pymysql</span>
<span id="cb42-3"><a href="join-tabel-subkueri.html#cb42-3" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb42-4"><a href="join-tabel-subkueri.html#cb42-4" tabindex="-1"></a></span>
<span id="cb42-5"><a href="join-tabel-subkueri.html#cb42-5" tabindex="-1"></a><span class="co"># membuat engine</span></span>
<span id="cb42-6"><a href="join-tabel-subkueri.html#cb42-6" tabindex="-1"></a>engine <span class="op">=</span> create_engine(<span class="st">&quot;mysql+pymysql://</span><span class="sc">{user}</span><span class="st">:</span><span class="sc">{pw}</span><span class="st">@localhost/</span><span class="sc">{db}</span><span class="st">&quot;</span></span>
<span id="cb42-7"><a href="join-tabel-subkueri.html#cb42-7" tabindex="-1"></a>                       .<span class="bu">format</span>(user<span class="op">=</span><span class="st">&quot;bakti&quot;</span>,</span>
<span id="cb42-8"><a href="join-tabel-subkueri.html#cb42-8" tabindex="-1"></a>                               pw<span class="op">=</span><span class="st">&quot;123&quot;</span>,</span>
<span id="cb42-9"><a href="join-tabel-subkueri.html#cb42-9" tabindex="-1"></a>                               db<span class="op">=</span><span class="st">&quot;join_tabel&quot;</span>))</span>
<span id="cb42-10"><a href="join-tabel-subkueri.html#cb42-10" tabindex="-1"></a></span>
<span id="cb42-11"><a href="join-tabel-subkueri.html#cb42-11" tabindex="-1"></a><span class="co"># engine koneksi ke database</span></span>
<span id="cb42-12"><a href="join-tabel-subkueri.html#cb42-12" tabindex="-1"></a>en_co <span class="op">=</span> engine.<span class="ex">connect</span>()</span></code></pre></div>
<div id="read-tabel-barang" class="section level4 unnumbered hasAnchor">
<h4>Read Tabel Barang<a href="join-tabel-subkueri.html#read-tabel-barang" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Selanjutnya, untuk membaca tabel sql menjadi DataFrame, tanpa mengeksekusi kueri apa pun, kita dapat menggunakan fungsi read_sql_table() yang ada pada library Pandas.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="join-tabel-subkueri.html#cb43-1" tabindex="-1"></a>barang <span class="op">=</span> pd.read_sql(<span class="st">&#39;barang&#39;</span>, en_co)</span>
<span id="cb43-2"><a href="join-tabel-subkueri.html#cb43-2" tabindex="-1"></a>barang</span></code></pre></div>
</div>
<div id="read-tabel-pelanggan" class="section level4 unnumbered hasAnchor">
<h4>Read Tabel Pelanggan<a href="join-tabel-subkueri.html#read-tabel-pelanggan" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="join-tabel-subkueri.html#cb44-1" tabindex="-1"></a>pelanggan <span class="op">=</span> pd.read_sql(<span class="st">&#39;pelanggan&#39;</span>, en_co)</span>
<span id="cb44-2"><a href="join-tabel-subkueri.html#cb44-2" tabindex="-1"></a>pelanggan</span></code></pre></div>
</div>
<div id="read-tabel-penjualan" class="section level4 unnumbered hasAnchor">
<h4>Read Tabel Penjualan<a href="join-tabel-subkueri.html#read-tabel-penjualan" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="join-tabel-subkueri.html#cb45-1" tabindex="-1"></a>penjualan <span class="op">=</span> pd.read_sql(<span class="st">&#39;penjualan&#39;</span>, en_co)</span>
<span id="cb45-2"><a href="join-tabel-subkueri.html#cb45-2" tabindex="-1"></a>penjualan</span></code></pre></div>
</div>
<div id="read-tabel-penjulan-detail" class="section level4 unnumbered hasAnchor">
<h4>Read Tabel Penjulan Detail<a href="join-tabel-subkueri.html#read-tabel-penjulan-detail" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="join-tabel-subkueri.html#cb46-1" tabindex="-1"></a>detail_penjualan <span class="op">=</span> pd.read_sql(<span class="st">&#39;penjualan_detail&#39;</span>, en_co)</span>
<span id="cb46-2"><a href="join-tabel-subkueri.html#cb46-2" tabindex="-1"></a>detail_penjualan</span></code></pre></div>
</div>
</div>
</div>
<div id="join-tabel" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Join Tabel<a href="join-tabel-subkueri.html#join-tabel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>SQL JOIN adalah fungsi yang disediakan SQL yang digunakan untuk menggabungkan tabel melalui kolom atau key tertentu yang nilainya saling terkait untuk memperoleh sekumpulan data dengan informasi yang lengkap. Dengan perintah JOIN pengguna dapat menggabungkan beberapa tabel agar mendapat informasi secara lengkap sesuai yang dibutuhkan untuk analisis. Beberapa jenis join tabel ini akan dijelaskan satu persatu pada sub-topik berikut.</p>
<p><img align="middle" src="images/bab4/join_tabel.png"  width = 100% /></p>
<div id="inner-join" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> INNER JOIN<a href="join-tabel-subkueri.html#inner-join" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pada MySQL, penulisan <code>INNER JOIN</code> dapat dilakukan dengan tiga cara yaitu (1) menggunakan klausa <code>INNER JOIN</code> (2) menggunakan klausa <code>CROSS JOIN</code> (3) cukup menggunakan klausa <code>JOIN</code> saja. Pengguna bebas menggunakan sintaks yang mana saja asal konsisten, penulis lebih prefer menggunakan JOIN saja, karena lebih simpel.</p>
<p>Sebagai contoh kita akan menampilkan data pelanggan yang melakukan pesanan, query yang kita jalankan:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="join-tabel-subkueri.html#cb47-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb47-2"><a href="join-tabel-subkueri.html#cb47-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb47-3"><a href="join-tabel-subkueri.html#cb47-3" tabindex="-1"></a><span class="st">SELECT pl.id_pelanggan, nama, tgl_transaksi, total_transaksi</span></span>
<span id="cb47-4"><a href="join-tabel-subkueri.html#cb47-4" tabindex="-1"></a><span class="st">  FROM pelanggan AS pl</span></span>
<span id="cb47-5"><a href="join-tabel-subkueri.html#cb47-5" tabindex="-1"></a><span class="st">    JOIN penjualan AS pn</span></span>
<span id="cb47-6"><a href="join-tabel-subkueri.html#cb47-6" tabindex="-1"></a><span class="st">      ON pl.id_pelanggan = pn.id_pelanggan</span></span>
<span id="cb47-7"><a href="join-tabel-subkueri.html#cb47-7" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb47-8"><a href="join-tabel-subkueri.html#cb47-8" tabindex="-1"></a></span>
<span id="cb47-9"><a href="join-tabel-subkueri.html#cb47-9" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb47-10"><a href="join-tabel-subkueri.html#cb47-10" tabindex="-1"></a>pd.read_sql(sql, en_co)</span></code></pre></div>
<p>Tabel yang dihasilkan adalah tabel yang berisikan nilai yang sama pada kedua tabel (matching values). Jika menggunakan klausa <code>USING</code>, maka query akan berbentuk seperti berikut:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="join-tabel-subkueri.html#cb48-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb48-2"><a href="join-tabel-subkueri.html#cb48-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb48-3"><a href="join-tabel-subkueri.html#cb48-3" tabindex="-1"></a><span class="st">SELECT pl.id_pelanggan, nama, tgl_transaksi, total_transaksi</span></span>
<span id="cb48-4"><a href="join-tabel-subkueri.html#cb48-4" tabindex="-1"></a><span class="st">  FROM pelanggan AS pl</span></span>
<span id="cb48-5"><a href="join-tabel-subkueri.html#cb48-5" tabindex="-1"></a><span class="st">    JOIN penjualan AS pn</span></span>
<span id="cb48-6"><a href="join-tabel-subkueri.html#cb48-6" tabindex="-1"></a><span class="st">      USING(id_pelanggan)</span></span>
<span id="cb48-7"><a href="join-tabel-subkueri.html#cb48-7" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb48-8"><a href="join-tabel-subkueri.html#cb48-8" tabindex="-1"></a></span>
<span id="cb48-9"><a href="join-tabel-subkueri.html#cb48-9" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb48-10"><a href="join-tabel-subkueri.html#cb48-10" tabindex="-1"></a>pd.read_sql(sql, en_co)</span></code></pre></div>
<p><strong>Kuis:</strong></p>
<ul>
<li>Berdasarkan hasil diatas, pada saat kapan sebiaknya anda akan menggunakan join tabel?</li>
</ul>
</div>
<div id="left-join" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> LEFT JOIN<a href="join-tabel-subkueri.html#left-join" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pada LEFT JOIN, semua data pada tabel sebelah kiri akan ditampilkan, sedangkan data pada tabel disebelah kanan hanya akan ditampilkan jika data terkait pada tabel tersebut muncul di tabel sebelah kiri. Contohnya, kita tampilkan semua data pelanggan beserta data transaksinya, jalankan query berikut:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="join-tabel-subkueri.html#cb49-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb49-2"><a href="join-tabel-subkueri.html#cb49-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb49-3"><a href="join-tabel-subkueri.html#cb49-3" tabindex="-1"></a><span class="st">SELECT *</span></span>
<span id="cb49-4"><a href="join-tabel-subkueri.html#cb49-4" tabindex="-1"></a><span class="st">  FROM pelanggan AS pl</span></span>
<span id="cb49-5"><a href="join-tabel-subkueri.html#cb49-5" tabindex="-1"></a><span class="st">    LEFT JOIN penjualan AS pn </span></span>
<span id="cb49-6"><a href="join-tabel-subkueri.html#cb49-6" tabindex="-1"></a><span class="st">      USING(id_pelanggan)</span></span>
<span id="cb49-7"><a href="join-tabel-subkueri.html#cb49-7" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb49-8"><a href="join-tabel-subkueri.html#cb49-8" tabindex="-1"></a></span>
<span id="cb49-9"><a href="join-tabel-subkueri.html#cb49-9" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb49-10"><a href="join-tabel-subkueri.html#cb49-10" tabindex="-1"></a>pd.read_sql(sql, en_co)</span></code></pre></div>
</div>
<div id="left-join-partial" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> LEFT JOIN (Partial)<a href="join-tabel-subkueri.html#left-join-partial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Tabel yang dihasilkan akan mengandung seluruh nilai tabel di sisi kiri, dengan nilai yang sama antara tabel kiri dan kanan.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="join-tabel-subkueri.html#cb50-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb50-2"><a href="join-tabel-subkueri.html#cb50-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb50-3"><a href="join-tabel-subkueri.html#cb50-3" tabindex="-1"></a><span class="st">SELECT *</span></span>
<span id="cb50-4"><a href="join-tabel-subkueri.html#cb50-4" tabindex="-1"></a><span class="st">  FROM pelanggan AS pl</span></span>
<span id="cb50-5"><a href="join-tabel-subkueri.html#cb50-5" tabindex="-1"></a><span class="st">    LEFT JOIN penjualan AS pn </span></span>
<span id="cb50-6"><a href="join-tabel-subkueri.html#cb50-6" tabindex="-1"></a><span class="st">      USING(id_pelanggan)</span></span>
<span id="cb50-7"><a href="join-tabel-subkueri.html#cb50-7" tabindex="-1"></a><span class="st">        WHERE pn.id_pelanggan IS NULL</span></span>
<span id="cb50-8"><a href="join-tabel-subkueri.html#cb50-8" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb50-9"><a href="join-tabel-subkueri.html#cb50-9" tabindex="-1"></a></span>
<span id="cb50-10"><a href="join-tabel-subkueri.html#cb50-10" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb50-11"><a href="join-tabel-subkueri.html#cb50-11" tabindex="-1"></a>pd.read_sql(sql, en_co)</span></code></pre></div>
<p><strong>Kuis:</strong></p>
<ul>
<li>Berdasarkan hasil diatas, pada saat kapan sebiaknya anda akan menggunakan Left Join (Partial)?</li>
</ul>
</div>
<div id="right-join" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> RIGHT JOIN<a href="join-tabel-subkueri.html#right-join" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Kebalikan dari LEFT JOIN, pada RIGHT JOIN, data pada tabel sebelah kanan akan ditampilkan semua, sedangkan data pada sebelah kiri hanya ditampilkan jika data terkait pada tabel tersebut muncul pada tabel sebelah kanan.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="join-tabel-subkueri.html#cb51-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb51-2"><a href="join-tabel-subkueri.html#cb51-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb51-3"><a href="join-tabel-subkueri.html#cb51-3" tabindex="-1"></a><span class="st">SELECT *</span></span>
<span id="cb51-4"><a href="join-tabel-subkueri.html#cb51-4" tabindex="-1"></a><span class="st">  FROM pelanggan pl</span></span>
<span id="cb51-5"><a href="join-tabel-subkueri.html#cb51-5" tabindex="-1"></a><span class="st">    RIGHT JOIN penjualan </span></span>
<span id="cb51-6"><a href="join-tabel-subkueri.html#cb51-6" tabindex="-1"></a><span class="st">      USING(id_pelanggan)</span></span>
<span id="cb51-7"><a href="join-tabel-subkueri.html#cb51-7" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb51-8"><a href="join-tabel-subkueri.html#cb51-8" tabindex="-1"></a></span>
<span id="cb51-9"><a href="join-tabel-subkueri.html#cb51-9" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb51-10"><a href="join-tabel-subkueri.html#cb51-10" tabindex="-1"></a>pd.read_sql(sql, en_co)</span></code></pre></div>
<p><strong>Kuis:</strong></p>
<ul>
<li>Perlukah RIGHT JOIN?</li>
</ul>
<p>Jika kita teliti lebih lanjut, sebenarnya right join hanya memindah posisi tabel, dari kiri ke kanan, contoh query pada right join dapat kita ubah dengan menjadi LEFT JOIN dengan mengubah posisi tabel.</p>
</div>
<div id="full-join" class="section level3 hasAnchor" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> FULL JOIN<a href="join-tabel-subkueri.html#full-join" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Tabel yang dihasilkan adalah tabel dengan semua nilai dari kedua tabel. Apabila terdapat nilai yang tidak memiliki kesamaan dari kedua tabel, maka muncul nilai null.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="join-tabel-subkueri.html#cb52-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb52-2"><a href="join-tabel-subkueri.html#cb52-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb52-3"><a href="join-tabel-subkueri.html#cb52-3" tabindex="-1"></a><span class="st">SELECT *</span></span>
<span id="cb52-4"><a href="join-tabel-subkueri.html#cb52-4" tabindex="-1"></a><span class="st">  FROM penjualan AS pn</span></span>
<span id="cb52-5"><a href="join-tabel-subkueri.html#cb52-5" tabindex="-1"></a><span class="st">    JOIN penjualan_detail AS pede</span></span>
<span id="cb52-6"><a href="join-tabel-subkueri.html#cb52-6" tabindex="-1"></a><span class="st">      ON pn.id_transaksi != pede.id_transaksi</span></span>
<span id="cb52-7"><a href="join-tabel-subkueri.html#cb52-7" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb52-8"><a href="join-tabel-subkueri.html#cb52-8" tabindex="-1"></a></span>
<span id="cb52-9"><a href="join-tabel-subkueri.html#cb52-9" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb52-10"><a href="join-tabel-subkueri.html#cb52-10" tabindex="-1"></a>pd.read_sql(sql, en_co)</span></code></pre></div>
</div>
<div id="implisit-join-tabel" class="section level3 hasAnchor" number="4.3.6">
<h3><span class="header-section-number">4.3.6</span> Implisit Join Tabel<a href="join-tabel-subkueri.html#implisit-join-tabel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sejauh ini, kita menampilkan data dari beberapa tabel MySQL dengan menggunakan klausa JOIN. Selain menggunakan klausa JOIN, terdapat satu cara lagi untuk menggabungkan tabel MySQL, yaitu menggunakan implisit join, disebut implisit join karena kita tidak menggunakan klausa JOIN, pada implisit join, kriteria hubungan antar tabel di definisikan pada klausa WHERE. Sebagai contoh, mari kita gabungkan tabel pelanggan dan penjualan, jalankan query berikut:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="join-tabel-subkueri.html#cb53-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb53-2"><a href="join-tabel-subkueri.html#cb53-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb53-3"><a href="join-tabel-subkueri.html#cb53-3" tabindex="-1"></a><span class="st">SELECT pl.id_pelanggan, nama, id_transaksi, tgl_transaksi, total_transaksi</span></span>
<span id="cb53-4"><a href="join-tabel-subkueri.html#cb53-4" tabindex="-1"></a><span class="st">  FROM pelanggan pl, penjualan pn</span></span>
<span id="cb53-5"><a href="join-tabel-subkueri.html#cb53-5" tabindex="-1"></a><span class="st">    WHERE pl.id_pelanggan = pn.id_pelanggan</span></span>
<span id="cb53-6"><a href="join-tabel-subkueri.html#cb53-6" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb53-7"><a href="join-tabel-subkueri.html#cb53-7" tabindex="-1"></a></span>
<span id="cb53-8"><a href="join-tabel-subkueri.html#cb53-8" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb53-9"><a href="join-tabel-subkueri.html#cb53-9" tabindex="-1"></a>pd.read_sql(sql, en_co)</span></code></pre></div>
<p>Perhatikan bahwa hasil tersebut sama persis dengan hasil pada contoh INNER JOIN, sehingga dapat disimpulkan bahwa implisit join = inner join.</p>
<p>Implisit JOIN ini merupakan cara lama ketika pertama kali standar SQL dibuat, setelah muncul standar yang lebih baru (SQL2) maka mulai digunakanlah klausa JOIN. Saya sendiri prefer menggunakan klausa JOIN karena lebih mudah dibaca dan dipahami, terutama hubungan antara tabel yang digabungkan.</p>
<p>Pada bentuk klausa JOIN, hubungan antar tabel dinyatakan pada klausa ON atau USING, sedangkan filter datanya dilakukan pada klausa WHERE, misal:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="join-tabel-subkueri.html#cb54-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb54-2"><a href="join-tabel-subkueri.html#cb54-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb54-3"><a href="join-tabel-subkueri.html#cb54-3" tabindex="-1"></a><span class="st">SELECT pl.id_pelanggan, nama, id_transaksi, tgl_transaksi, total_transaksi</span></span>
<span id="cb54-4"><a href="join-tabel-subkueri.html#cb54-4" tabindex="-1"></a><span class="st">  FROM pelanggan pl</span></span>
<span id="cb54-5"><a href="join-tabel-subkueri.html#cb54-5" tabindex="-1"></a><span class="st">    LEFT JOIN penjualan pn USING (id_pelanggan)</span></span>
<span id="cb54-6"><a href="join-tabel-subkueri.html#cb54-6" tabindex="-1"></a><span class="st">      WHERE pl.id_pelanggan = 2 OR pl.id_pelanggan = 1</span></span>
<span id="cb54-7"><a href="join-tabel-subkueri.html#cb54-7" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb54-8"><a href="join-tabel-subkueri.html#cb54-8" tabindex="-1"></a></span>
<span id="cb54-9"><a href="join-tabel-subkueri.html#cb54-9" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb54-10"><a href="join-tabel-subkueri.html#cb54-10" tabindex="-1"></a>pd.read_sql(sql, en_co)</span></code></pre></div>
<p>Sedangkan pada implisit JOIN, hubungan antar tabel dan filter datanya, semua didefinisikan pada klausa WHERE, misal:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="join-tabel-subkueri.html#cb55-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb55-2"><a href="join-tabel-subkueri.html#cb55-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb55-3"><a href="join-tabel-subkueri.html#cb55-3" tabindex="-1"></a><span class="st">SELECT pl.id_pelanggan, nama, id_transaksi, tgl_transaksi, total_transaksi</span></span>
<span id="cb55-4"><a href="join-tabel-subkueri.html#cb55-4" tabindex="-1"></a><span class="st">  FROM pelanggan pl, penjualan pn</span></span>
<span id="cb55-5"><a href="join-tabel-subkueri.html#cb55-5" tabindex="-1"></a><span class="st">    WHERE pl.id_pelanggan = pn.id_pelanggan</span></span>
<span id="cb55-6"><a href="join-tabel-subkueri.html#cb55-6" tabindex="-1"></a><span class="st">      AND (pl.id_pelanggan = 2 OR pl.id_pelanggan = 1)</span></span>
<span id="cb55-7"><a href="join-tabel-subkueri.html#cb55-7" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb55-8"><a href="join-tabel-subkueri.html#cb55-8" tabindex="-1"></a></span>
<span id="cb55-9"><a href="join-tabel-subkueri.html#cb55-9" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb55-10"><a href="join-tabel-subkueri.html#cb55-10" tabindex="-1"></a>pd.read_sql(sql, en_co)</span></code></pre></div>
</div>
</div>
<div id="studi-kasus" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Studi Kasus<a href="join-tabel-subkueri.html#studi-kasus" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Database JNE2 adalah data fiktif yang dikembangkan oleh tim dsciencelabs untuk pelatihan Data Analytics with Python &amp; SQL. Kumpulan data tersebut berisi informasi tentang pelanggan, produk, pesanan, logistik, promosi, dan kampanye pemasaran digital. Tugas peserta pelatihan di sini adalah menjawab beberapa pertanyaan terkait bisnis, mendapatkan wawasan, dan memberikan beberapa rekomendasi untuk meningkatkan pendapatan suatu perusahaan.</p>
<div id="soal-1" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Soal 1<a href="join-tabel-subkueri.html#soal-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Andaikan Divisi Marketing akan memberikan promosi selama perayaan Imlek untuk pelanggan wanita di Jepang melalui email. Bagaimana anda mendapatkan data tentang berapa banyak pelanggan yang harus dipromosikan setiap email!</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="join-tabel-subkueri.html#cb56-1" tabindex="-1"></a><span class="im">from</span> sqlalchemy <span class="im">import</span> create_engine</span>
<span id="cb56-2"><a href="join-tabel-subkueri.html#cb56-2" tabindex="-1"></a><span class="im">import</span> pymysql</span>
<span id="cb56-3"><a href="join-tabel-subkueri.html#cb56-3" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb56-4"><a href="join-tabel-subkueri.html#cb56-4" tabindex="-1"></a></span>
<span id="cb56-5"><a href="join-tabel-subkueri.html#cb56-5" tabindex="-1"></a><span class="co"># membuat engine</span></span>
<span id="cb56-6"><a href="join-tabel-subkueri.html#cb56-6" tabindex="-1"></a>engine <span class="op">=</span> create_engine(<span class="st">&quot;mysql+pymysql://</span><span class="sc">{user}</span><span class="st">:</span><span class="sc">{pw}</span><span class="st">@localhost/</span><span class="sc">{db}</span><span class="st">&quot;</span></span>
<span id="cb56-7"><a href="join-tabel-subkueri.html#cb56-7" tabindex="-1"></a>                       .<span class="bu">format</span>(user<span class="op">=</span><span class="st">&quot;bakti&quot;</span>,</span>
<span id="cb56-8"><a href="join-tabel-subkueri.html#cb56-8" tabindex="-1"></a>                               pw<span class="op">=</span><span class="st">&quot;123&quot;</span>,</span>
<span id="cb56-9"><a href="join-tabel-subkueri.html#cb56-9" tabindex="-1"></a>                               db<span class="op">=</span><span class="st">&quot;jne2&quot;</span>))</span>
<span id="cb56-10"><a href="join-tabel-subkueri.html#cb56-10" tabindex="-1"></a></span>
<span id="cb56-11"><a href="join-tabel-subkueri.html#cb56-11" tabindex="-1"></a><span class="co"># engine koneksi ke database</span></span>
<span id="cb56-12"><a href="join-tabel-subkueri.html#cb56-12" tabindex="-1"></a>en_co2 <span class="op">=</span> engine.<span class="ex">connect</span>()</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="join-tabel-subkueri.html#cb57-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb57-2"><a href="join-tabel-subkueri.html#cb57-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb57-3"><a href="join-tabel-subkueri.html#cb57-3" tabindex="-1"></a><span class="st">SELECT id, email</span></span>
<span id="cb57-4"><a href="join-tabel-subkueri.html#cb57-4" tabindex="-1"></a><span class="st">  FROM `users` </span></span>
<span id="cb57-5"><a href="join-tabel-subkueri.html#cb57-5" tabindex="-1"></a><span class="st">    WHERE gender = &#39;F&#39; AND country = &#39;Japan&#39;</span></span>
<span id="cb57-6"><a href="join-tabel-subkueri.html#cb57-6" tabindex="-1"></a><span class="st">      ORDER BY 1</span></span>
<span id="cb57-7"><a href="join-tabel-subkueri.html#cb57-7" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb57-8"><a href="join-tabel-subkueri.html#cb57-8" tabindex="-1"></a></span>
<span id="cb57-9"><a href="join-tabel-subkueri.html#cb57-9" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb57-10"><a href="join-tabel-subkueri.html#cb57-10" tabindex="-1"></a>pd.read_sql(sql, en_co2)</span></code></pre></div>
<p><strong>Kuis:</strong></p>
<ul>
<li>Apakah maksud dari <code>ORDER BY 1</code> ?</li>
</ul>
</div>
<div id="soal-2" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Soal 2<a href="join-tabel-subkueri.html#soal-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cara pemasaran apa yang harus perlu ditingkatkan oleh marketing?</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="join-tabel-subkueri.html#cb58-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb58-2"><a href="join-tabel-subkueri.html#cb58-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb58-3"><a href="join-tabel-subkueri.html#cb58-3" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb58-4"><a href="join-tabel-subkueri.html#cb58-4" tabindex="-1"></a><span class="st">  u.traffic_source, </span></span>
<span id="cb58-5"><a href="join-tabel-subkueri.html#cb58-5" tabindex="-1"></a><span class="st">  COUNT(DISTINCT oi.user_id) total_customer</span></span>
<span id="cb58-6"><a href="join-tabel-subkueri.html#cb58-6" tabindex="-1"></a><span class="st">FROM `order_items` oi</span></span>
<span id="cb58-7"><a href="join-tabel-subkueri.html#cb58-7" tabindex="-1"></a><span class="st">LEFT JOIN `users` u</span></span>
<span id="cb58-8"><a href="join-tabel-subkueri.html#cb58-8" tabindex="-1"></a><span class="st">ON oi.user_id = u.id</span></span>
<span id="cb58-9"><a href="join-tabel-subkueri.html#cb58-9" tabindex="-1"></a><span class="st">WHERE oi.status NOT IN (&#39;Cancelled&#39;,&#39;Returned&#39;)</span></span>
<span id="cb58-10"><a href="join-tabel-subkueri.html#cb58-10" tabindex="-1"></a><span class="st">GROUP BY 1</span></span>
<span id="cb58-11"><a href="join-tabel-subkueri.html#cb58-11" tabindex="-1"></a><span class="st">ORDER BY 2 DESC</span></span>
<span id="cb58-12"><a href="join-tabel-subkueri.html#cb58-12" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb58-13"><a href="join-tabel-subkueri.html#cb58-13" tabindex="-1"></a></span>
<span id="cb58-14"><a href="join-tabel-subkueri.html#cb58-14" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb58-15"><a href="join-tabel-subkueri.html#cb58-15" tabindex="-1"></a>pd.read_sql(sql, en_co2)</span></code></pre></div>
</div>
<div id="soal-3" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Soal 3<a href="join-tabel-subkueri.html#soal-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Berikan daftar 10 id pelanggan dengan total pembelian keseluruhan terbesar. Dalam hal ini Marketing akan memberikan diskon untuk kampanye 7.7!</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="join-tabel-subkueri.html#cb59-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb59-2"><a href="join-tabel-subkueri.html#cb59-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb59-3"><a href="join-tabel-subkueri.html#cb59-3" tabindex="-1"></a><span class="st">SELECT oi.user_id, u.email,</span></span>
<span id="cb59-4"><a href="join-tabel-subkueri.html#cb59-4" tabindex="-1"></a><span class="st">  SUM(oi.sale_price*o.num_of_item) total_purchase</span></span>
<span id="cb59-5"><a href="join-tabel-subkueri.html#cb59-5" tabindex="-1"></a><span class="st">FROM `order_items` oi</span></span>
<span id="cb59-6"><a href="join-tabel-subkueri.html#cb59-6" tabindex="-1"></a><span class="st">  LEFT JOIN `users` u ON oi.user_id = u.id</span></span>
<span id="cb59-7"><a href="join-tabel-subkueri.html#cb59-7" tabindex="-1"></a><span class="st">  LEFT JOIN `orders` o ON oi.order_id = o.order_id</span></span>
<span id="cb59-8"><a href="join-tabel-subkueri.html#cb59-8" tabindex="-1"></a><span class="st">WHERE oi.status NOT IN (&#39;Cancelled&#39;,&#39;Returned&#39;)</span></span>
<span id="cb59-9"><a href="join-tabel-subkueri.html#cb59-9" tabindex="-1"></a><span class="st">GROUP BY 1, 2</span></span>
<span id="cb59-10"><a href="join-tabel-subkueri.html#cb59-10" tabindex="-1"></a><span class="st">ORDER BY 3 DESC</span></span>
<span id="cb59-11"><a href="join-tabel-subkueri.html#cb59-11" tabindex="-1"></a><span class="st">LIMIT 10</span></span>
<span id="cb59-12"><a href="join-tabel-subkueri.html#cb59-12" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb59-13"><a href="join-tabel-subkueri.html#cb59-13" tabindex="-1"></a></span>
<span id="cb59-14"><a href="join-tabel-subkueri.html#cb59-14" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb59-15"><a href="join-tabel-subkueri.html#cb59-15" tabindex="-1"></a>pd.read_sql(sql, en_co2)</span></code></pre></div>
</div>
<div id="soal-4" class="section level3 hasAnchor" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> Soal 4<a href="join-tabel-subkueri.html#soal-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Berapa banyak penjualan Marketing setiap bulan? Apakah tinggi atau rendah dibandingkan dengan bulan lalu?</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="join-tabel-subkueri.html#cb60-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb60-2"><a href="join-tabel-subkueri.html#cb60-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb60-3"><a href="join-tabel-subkueri.html#cb60-3" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb60-4"><a href="join-tabel-subkueri.html#cb60-4" tabindex="-1"></a><span class="st">  DATE_FORMAT(oi.created_at,&#39;MONTH&#39;) AS order_date,</span></span>
<span id="cb60-5"><a href="join-tabel-subkueri.html#cb60-5" tabindex="-1"></a><span class="st">  SUM(oi.sale_price*o.num_of_item) AS revenue,</span></span>
<span id="cb60-6"><a href="join-tabel-subkueri.html#cb60-6" tabindex="-1"></a><span class="st">  COUNT(DISTINCT oi.order_id) AS order_count,</span></span>
<span id="cb60-7"><a href="join-tabel-subkueri.html#cb60-7" tabindex="-1"></a><span class="st">  COUNT(DISTINCT oi.user_id) AS customers_purchased</span></span>
<span id="cb60-8"><a href="join-tabel-subkueri.html#cb60-8" tabindex="-1"></a><span class="st">FROM `order_items` AS oi</span></span>
<span id="cb60-9"><a href="join-tabel-subkueri.html#cb60-9" tabindex="-1"></a><span class="st">LEFT JOIN `orders` AS o </span></span>
<span id="cb60-10"><a href="join-tabel-subkueri.html#cb60-10" tabindex="-1"></a><span class="st">ON oi.order_id = o.order_id</span></span>
<span id="cb60-11"><a href="join-tabel-subkueri.html#cb60-11" tabindex="-1"></a><span class="st">WHERE oi.status NOT IN (&#39;Cancelled&#39;,&#39;Returned&#39;)</span></span>
<span id="cb60-12"><a href="join-tabel-subkueri.html#cb60-12" tabindex="-1"></a><span class="st">GROUP BY 1</span></span>
<span id="cb60-13"><a href="join-tabel-subkueri.html#cb60-13" tabindex="-1"></a><span class="st">ORDER BY 1 DESC</span></span>
<span id="cb60-14"><a href="join-tabel-subkueri.html#cb60-14" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb60-15"><a href="join-tabel-subkueri.html#cb60-15" tabindex="-1"></a></span>
<span id="cb60-16"><a href="join-tabel-subkueri.html#cb60-16" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb60-17"><a href="join-tabel-subkueri.html#cb60-17" tabindex="-1"></a>pd.read_sql(sql, en_co2)</span></code></pre></div>
<p><strong>Catatan:</strong> Hasilnya masih salah karena format tanggal dan jam belum terdeteksi dengan baik.</p>
</div>
<div id="soal-5" class="section level3 hasAnchor" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> Soal 5<a href="join-tabel-subkueri.html#soal-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Siapa saja pelanggan JNE?</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="join-tabel-subkueri.html#cb61-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb61-2"><a href="join-tabel-subkueri.html#cb61-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb61-3"><a href="join-tabel-subkueri.html#cb61-3" tabindex="-1"></a><span class="st">WITH</span></span>
<span id="cb61-4"><a href="join-tabel-subkueri.html#cb61-4" tabindex="-1"></a><span class="st">cust AS (</span></span>
<span id="cb61-5"><a href="join-tabel-subkueri.html#cb61-5" tabindex="-1"></a><span class="st">  SELECT </span></span>
<span id="cb61-6"><a href="join-tabel-subkueri.html#cb61-6" tabindex="-1"></a><span class="st">    DISTINCT oi.user_id,</span></span>
<span id="cb61-7"><a href="join-tabel-subkueri.html#cb61-7" tabindex="-1"></a><span class="st">    SUM(CASE WHEN u.gender = &#39;M&#39; THEN 1 ELSE null END) AS male,</span></span>
<span id="cb61-8"><a href="join-tabel-subkueri.html#cb61-8" tabindex="-1"></a><span class="st">    SUM(CASE WHEN u.gender = &#39;F&#39; THEN 1 ELSE null END) AS female,</span></span>
<span id="cb61-9"><a href="join-tabel-subkueri.html#cb61-9" tabindex="-1"></a><span class="st">    u.country AS country</span></span>
<span id="cb61-10"><a href="join-tabel-subkueri.html#cb61-10" tabindex="-1"></a><span class="st">  FROM `order_items` AS oi</span></span>
<span id="cb61-11"><a href="join-tabel-subkueri.html#cb61-11" tabindex="-1"></a><span class="st">  INNER JOIN `users` AS u  </span></span>
<span id="cb61-12"><a href="join-tabel-subkueri.html#cb61-12" tabindex="-1"></a><span class="st">  ON oi.user_id = u.id</span></span>
<span id="cb61-13"><a href="join-tabel-subkueri.html#cb61-13" tabindex="-1"></a><span class="st">  WHERE oi.status NOT IN (&#39;Cancelled&#39;,&#39;Returned&#39;)</span></span>
<span id="cb61-14"><a href="join-tabel-subkueri.html#cb61-14" tabindex="-1"></a><span class="st">  GROUP BY 1, 4</span></span>
<span id="cb61-15"><a href="join-tabel-subkueri.html#cb61-15" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb61-16"><a href="join-tabel-subkueri.html#cb61-16" tabindex="-1"></a></span>
<span id="cb61-17"><a href="join-tabel-subkueri.html#cb61-17" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb61-18"><a href="join-tabel-subkueri.html#cb61-18" tabindex="-1"></a><span class="st">  c.country,</span></span>
<span id="cb61-19"><a href="join-tabel-subkueri.html#cb61-19" tabindex="-1"></a><span class="st">  COUNT(DISTINCT c.user_id) AS customers_count,</span></span>
<span id="cb61-20"><a href="join-tabel-subkueri.html#cb61-20" tabindex="-1"></a><span class="st">  COUNT(c.female) AS female,</span></span>
<span id="cb61-21"><a href="join-tabel-subkueri.html#cb61-21" tabindex="-1"></a><span class="st">  COUNT(c.male) AS male</span></span>
<span id="cb61-22"><a href="join-tabel-subkueri.html#cb61-22" tabindex="-1"></a><span class="st">FROM cust AS c</span></span>
<span id="cb61-23"><a href="join-tabel-subkueri.html#cb61-23" tabindex="-1"></a><span class="st">GROUP BY 1</span></span>
<span id="cb61-24"><a href="join-tabel-subkueri.html#cb61-24" tabindex="-1"></a><span class="st">ORDER BY 2 DESC</span></span>
<span id="cb61-25"><a href="join-tabel-subkueri.html#cb61-25" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb61-26"><a href="join-tabel-subkueri.html#cb61-26" tabindex="-1"></a></span>
<span id="cb61-27"><a href="join-tabel-subkueri.html#cb61-27" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb61-28"><a href="join-tabel-subkueri.html#cb61-28" tabindex="-1"></a>pd.read_sql(sql, en_co2)</span></code></pre></div>
</div>
<div id="soal-6" class="section level3 hasAnchor" number="4.4.6">
<h3><span class="header-section-number">4.4.6</span> Soal 6<a href="join-tabel-subkueri.html#soal-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Buktikan bahwa Mayoritas pelanggan kami berasal dari China, Amerika Serikat, lalu Brasil.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="join-tabel-subkueri.html#cb62-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb62-2"><a href="join-tabel-subkueri.html#cb62-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb62-3"><a href="join-tabel-subkueri.html#cb62-3" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb62-4"><a href="join-tabel-subkueri.html#cb62-4" tabindex="-1"></a><span class="st">  o.gender,</span></span>
<span id="cb62-5"><a href="join-tabel-subkueri.html#cb62-5" tabindex="-1"></a><span class="st">  SUM(oi.sale_price*o.num_of_item) revenue,</span></span>
<span id="cb62-6"><a href="join-tabel-subkueri.html#cb62-6" tabindex="-1"></a><span class="st">  SUM(o.num_of_item) quantity</span></span>
<span id="cb62-7"><a href="join-tabel-subkueri.html#cb62-7" tabindex="-1"></a><span class="st">FROM `order_items` oi</span></span>
<span id="cb62-8"><a href="join-tabel-subkueri.html#cb62-8" tabindex="-1"></a><span class="st">LEFT JOIN `orders` o</span></span>
<span id="cb62-9"><a href="join-tabel-subkueri.html#cb62-9" tabindex="-1"></a><span class="st">ON oi.order_id = o.order_id</span></span>
<span id="cb62-10"><a href="join-tabel-subkueri.html#cb62-10" tabindex="-1"></a><span class="st">WHERE oi.status NOT IN (&#39;Cancelled&#39;,&#39;Returned&#39;)</span></span>
<span id="cb62-11"><a href="join-tabel-subkueri.html#cb62-11" tabindex="-1"></a><span class="st">GROUP BY 1</span></span>
<span id="cb62-12"><a href="join-tabel-subkueri.html#cb62-12" tabindex="-1"></a><span class="st">ORDER BY 2</span></span>
<span id="cb62-13"><a href="join-tabel-subkueri.html#cb62-13" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb62-14"><a href="join-tabel-subkueri.html#cb62-14" tabindex="-1"></a></span>
<span id="cb62-15"><a href="join-tabel-subkueri.html#cb62-15" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb62-16"><a href="join-tabel-subkueri.html#cb62-16" tabindex="-1"></a>pd.read_sql(sql, en_co2)</span></code></pre></div>
</div>
<div id="soal-7" class="section level3 hasAnchor" number="4.4.7">
<h3><span class="header-section-number">4.4.7</span> Soal 7<a href="join-tabel-subkueri.html#soal-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Berapa proporsi pelanggan berdasarkan jenis kelamin di setiap negara?</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="join-tabel-subkueri.html#cb63-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb63-2"><a href="join-tabel-subkueri.html#cb63-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb63-3"><a href="join-tabel-subkueri.html#cb63-3" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb63-4"><a href="join-tabel-subkueri.html#cb63-4" tabindex="-1"></a><span class="st">  CASE </span></span>
<span id="cb63-5"><a href="join-tabel-subkueri.html#cb63-5" tabindex="-1"></a><span class="st">    WHEN u.age &lt;15 THEN &#39;Kids&#39;</span></span>
<span id="cb63-6"><a href="join-tabel-subkueri.html#cb63-6" tabindex="-1"></a><span class="st">    WHEN u.age BETWEEN 15 AND 24 THEN &#39;Teenager&#39;</span></span>
<span id="cb63-7"><a href="join-tabel-subkueri.html#cb63-7" tabindex="-1"></a><span class="st">    WHEN u.age BETWEEN 25 AND 50 THEN &#39;Adult&#39;</span></span>
<span id="cb63-8"><a href="join-tabel-subkueri.html#cb63-8" tabindex="-1"></a><span class="st">    WHEN u.age &gt;50 THEN &#39;Eldery&#39; END AS age_group,</span></span>
<span id="cb63-9"><a href="join-tabel-subkueri.html#cb63-9" tabindex="-1"></a><span class="st">  COUNT(DISTINCT oi.user_id) total_customer</span></span>
<span id="cb63-10"><a href="join-tabel-subkueri.html#cb63-10" tabindex="-1"></a><span class="st">FROM `order_items` oi</span></span>
<span id="cb63-11"><a href="join-tabel-subkueri.html#cb63-11" tabindex="-1"></a><span class="st">LEFT JOIN `users` u</span></span>
<span id="cb63-12"><a href="join-tabel-subkueri.html#cb63-12" tabindex="-1"></a><span class="st">ON oi.user_id = u.id</span></span>
<span id="cb63-13"><a href="join-tabel-subkueri.html#cb63-13" tabindex="-1"></a><span class="st">WHERE oi.status NOT IN (&#39;Cancelled&#39;,&#39;Returned&#39;)</span></span>
<span id="cb63-14"><a href="join-tabel-subkueri.html#cb63-14" tabindex="-1"></a><span class="st">GROUP BY 1</span></span>
<span id="cb63-15"><a href="join-tabel-subkueri.html#cb63-15" tabindex="-1"></a><span class="st">ORDER BY 2 DESC</span></span>
<span id="cb63-16"><a href="join-tabel-subkueri.html#cb63-16" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb63-17"><a href="join-tabel-subkueri.html#cb63-17" tabindex="-1"></a></span>
<span id="cb63-18"><a href="join-tabel-subkueri.html#cb63-18" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb63-19"><a href="join-tabel-subkueri.html#cb63-19" tabindex="-1"></a>pd.read_sql(sql, en_co2)</span></code></pre></div>
</div>
<div id="soal-8" class="section level3 hasAnchor" number="4.4.8">
<h3><span class="header-section-number">4.4.8</span> Soal 8<a href="join-tabel-subkueri.html#soal-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Produk apa yang JNE jual paling banyak dan paling sedikit?</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="join-tabel-subkueri.html#cb64-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb64-2"><a href="join-tabel-subkueri.html#cb64-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb64-3"><a href="join-tabel-subkueri.html#cb64-3" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb64-4"><a href="join-tabel-subkueri.html#cb64-4" tabindex="-1"></a><span class="st">  p.brand,</span></span>
<span id="cb64-5"><a href="join-tabel-subkueri.html#cb64-5" tabindex="-1"></a><span class="st">  SUM(oi.sale_price*o.num_of_item) AS revenue,</span></span>
<span id="cb64-6"><a href="join-tabel-subkueri.html#cb64-6" tabindex="-1"></a><span class="st">  SUM(o.num_of_item) AS quantity</span></span>
<span id="cb64-7"><a href="join-tabel-subkueri.html#cb64-7" tabindex="-1"></a><span class="st">FROM `order_items` AS oi</span></span>
<span id="cb64-8"><a href="join-tabel-subkueri.html#cb64-8" tabindex="-1"></a><span class="st">  LEFT JOIN `orders` AS o ON oi.order_id = o.order_id</span></span>
<span id="cb64-9"><a href="join-tabel-subkueri.html#cb64-9" tabindex="-1"></a><span class="st">  LEFT JOIN `products` AS p ON oi.product_id = p.id</span></span>
<span id="cb64-10"><a href="join-tabel-subkueri.html#cb64-10" tabindex="-1"></a><span class="st">WHERE oi.status NOT IN (&#39;Cancelled&#39;,&#39;Returned&#39;)</span></span>
<span id="cb64-11"><a href="join-tabel-subkueri.html#cb64-11" tabindex="-1"></a><span class="st">GROUP BY 1</span></span>
<span id="cb64-12"><a href="join-tabel-subkueri.html#cb64-12" tabindex="-1"></a><span class="st">ORDER BY 3 DESC</span></span>
<span id="cb64-13"><a href="join-tabel-subkueri.html#cb64-13" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb64-14"><a href="join-tabel-subkueri.html#cb64-14" tabindex="-1"></a></span>
<span id="cb64-15"><a href="join-tabel-subkueri.html#cb64-15" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb64-16"><a href="join-tabel-subkueri.html#cb64-16" tabindex="-1"></a>pd.read_sql(sql, en_co2)</span></code></pre></div>
</div>
<div id="soal-9" class="section level3 hasAnchor" number="4.4.9">
<h3><span class="header-section-number">4.4.9</span> Soal 9<a href="join-tabel-subkueri.html#soal-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Merek yang paling banyak menghasilkan pendapatan?</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="join-tabel-subkueri.html#cb65-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb65-2"><a href="join-tabel-subkueri.html#cb65-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb65-3"><a href="join-tabel-subkueri.html#cb65-3" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb65-4"><a href="join-tabel-subkueri.html#cb65-4" tabindex="-1"></a><span class="st">  p.category,</span></span>
<span id="cb65-5"><a href="join-tabel-subkueri.html#cb65-5" tabindex="-1"></a><span class="st">  SUM(oi.sale_price*o.num_of_item) AS revenue,</span></span>
<span id="cb65-6"><a href="join-tabel-subkueri.html#cb65-6" tabindex="-1"></a><span class="st">  SUM(o.num_of_item) AS quantity</span></span>
<span id="cb65-7"><a href="join-tabel-subkueri.html#cb65-7" tabindex="-1"></a><span class="st">FROM `order_items` AS oi</span></span>
<span id="cb65-8"><a href="join-tabel-subkueri.html#cb65-8" tabindex="-1"></a><span class="st">LEFT JOIN `orders` AS o</span></span>
<span id="cb65-9"><a href="join-tabel-subkueri.html#cb65-9" tabindex="-1"></a><span class="st">ON oi.order_id = o.order_id</span></span>
<span id="cb65-10"><a href="join-tabel-subkueri.html#cb65-10" tabindex="-1"></a><span class="st">LEFT JOIN `products` AS p</span></span>
<span id="cb65-11"><a href="join-tabel-subkueri.html#cb65-11" tabindex="-1"></a><span class="st">ON oi.product_id = p.id</span></span>
<span id="cb65-12"><a href="join-tabel-subkueri.html#cb65-12" tabindex="-1"></a><span class="st">WHERE oi.status NOT IN (&#39;Cancelled&#39;,&#39;Returned&#39;)</span></span>
<span id="cb65-13"><a href="join-tabel-subkueri.html#cb65-13" tabindex="-1"></a><span class="st">GROUP BY 1</span></span>
<span id="cb65-14"><a href="join-tabel-subkueri.html#cb65-14" tabindex="-1"></a><span class="st">ORDER BY 3 DESC</span></span>
<span id="cb65-15"><a href="join-tabel-subkueri.html#cb65-15" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb65-16"><a href="join-tabel-subkueri.html#cb65-16" tabindex="-1"></a></span>
<span id="cb65-17"><a href="join-tabel-subkueri.html#cb65-17" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb65-18"><a href="join-tabel-subkueri.html#cb65-18" tabindex="-1"></a>pd.read_sql(sql, en_co2)</span></code></pre></div>
</div>
<div id="soal-10" class="section level3 hasAnchor" number="4.4.10">
<h3><span class="header-section-number">4.4.10</span> Soal 10<a href="join-tabel-subkueri.html#soal-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Merek &amp; kategori produk yang paling banyak dibatalkan dan dikembalikan.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="join-tabel-subkueri.html#cb66-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb66-2"><a href="join-tabel-subkueri.html#cb66-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb66-3"><a href="join-tabel-subkueri.html#cb66-3" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb66-4"><a href="join-tabel-subkueri.html#cb66-4" tabindex="-1"></a><span class="st">  p.brand,</span></span>
<span id="cb66-5"><a href="join-tabel-subkueri.html#cb66-5" tabindex="-1"></a><span class="st">  SUM(CASE WHEN oi.status = &#39;Cancelled&#39; THEN 1 ELSE null END) AS Cancelled,</span></span>
<span id="cb66-6"><a href="join-tabel-subkueri.html#cb66-6" tabindex="-1"></a><span class="st">  SUM(CASE WHEN oi.status = &#39;Returned&#39; THEN 1 ELSE null END) AS Returned</span></span>
<span id="cb66-7"><a href="join-tabel-subkueri.html#cb66-7" tabindex="-1"></a><span class="st">FROM `order_items` oi</span></span>
<span id="cb66-8"><a href="join-tabel-subkueri.html#cb66-8" tabindex="-1"></a><span class="st">LEFT JOIN `products` p</span></span>
<span id="cb66-9"><a href="join-tabel-subkueri.html#cb66-9" tabindex="-1"></a><span class="st">ON oi.product_id = p.id</span></span>
<span id="cb66-10"><a href="join-tabel-subkueri.html#cb66-10" tabindex="-1"></a><span class="st">GROUP BY 1</span></span>
<span id="cb66-11"><a href="join-tabel-subkueri.html#cb66-11" tabindex="-1"></a><span class="st">ORDER BY 2 DESC;</span></span>
<span id="cb66-12"><a href="join-tabel-subkueri.html#cb66-12" tabindex="-1"></a></span>
<span id="cb66-13"><a href="join-tabel-subkueri.html#cb66-13" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb66-14"><a href="join-tabel-subkueri.html#cb66-14" tabindex="-1"></a></span>
<span id="cb66-15"><a href="join-tabel-subkueri.html#cb66-15" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb66-16"><a href="join-tabel-subkueri.html#cb66-16" tabindex="-1"></a>pd.read_sql(sql, en_co2)</span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="join-tabel-subkueri.html#cb67-1" tabindex="-1"></a><span class="co"># Perintah SQL</span></span>
<span id="cb67-2"><a href="join-tabel-subkueri.html#cb67-2" tabindex="-1"></a>sql <span class="op">=</span> <span class="st">&#39;&#39;&#39; </span></span>
<span id="cb67-3"><a href="join-tabel-subkueri.html#cb67-3" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb67-4"><a href="join-tabel-subkueri.html#cb67-4" tabindex="-1"></a><span class="st">p.category,</span></span>
<span id="cb67-5"><a href="join-tabel-subkueri.html#cb67-5" tabindex="-1"></a><span class="st">SUM(CASE WHEN oi.status = &#39;Cancelled&#39; THEN 1 ELSE null END) AS Cancelled,</span></span>
<span id="cb67-6"><a href="join-tabel-subkueri.html#cb67-6" tabindex="-1"></a><span class="st">SUM(CASE WHEN oi.status = &#39;Returned&#39; THEN 1 ELSE null END) AS Returned</span></span>
<span id="cb67-7"><a href="join-tabel-subkueri.html#cb67-7" tabindex="-1"></a><span class="st">FROM `order_items` oi</span></span>
<span id="cb67-8"><a href="join-tabel-subkueri.html#cb67-8" tabindex="-1"></a><span class="st">LEFT JOIN `products` p</span></span>
<span id="cb67-9"><a href="join-tabel-subkueri.html#cb67-9" tabindex="-1"></a><span class="st">ON oi.product_id = p.id</span></span>
<span id="cb67-10"><a href="join-tabel-subkueri.html#cb67-10" tabindex="-1"></a><span class="st">GROUP BY 1</span></span>
<span id="cb67-11"><a href="join-tabel-subkueri.html#cb67-11" tabindex="-1"></a><span class="st">ORDER BY 2 DESC;</span></span>
<span id="cb67-12"><a href="join-tabel-subkueri.html#cb67-12" tabindex="-1"></a></span>
<span id="cb67-13"><a href="join-tabel-subkueri.html#cb67-13" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb67-14"><a href="join-tabel-subkueri.html#cb67-14" tabindex="-1"></a></span>
<span id="cb67-15"><a href="join-tabel-subkueri.html#cb67-15" tabindex="-1"></a><span class="co"># Eksekusi perintah  SQL</span></span>
<span id="cb67-16"><a href="join-tabel-subkueri.html#cb67-16" tabindex="-1"></a>pd.read_sql(sql, en_co2)</span></code></pre></div>
</div>
</div>
<div id="referensi" class="section level2 unnumbered hasAnchor">
<h2>Referensi<a href="join-tabel-subkueri.html#referensi" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="https://revou.co/panduan-teknis/sql-subquery" class="uri">https://revou.co/panduan-teknis/sql-subquery</a></li>
<li><a href="https://medium.com/@simonazhangzy/practice-real-sql-in-bigquery-with-the-public-e-commerce-dataset-f14838b2755b" class="uri">https://medium.com/@simonazhangzy/practice-real-sql-in-bigquery-with-the-public-e-commerce-dataset-f14838b2755b</a></li>
<li><a href="https://jagowebdev.com/menampilkan-data-dari-beberapa-tabel-mysql-join-pada-mysql/" class="uri">https://jagowebdev.com/menampilkan-data-dari-beberapa-tabel-mysql-join-pada-mysql/</a></li>
<li><a href="https://jagowebdev.com/wp-content/demo/files/join_pada_mysql.sql.txt" class="uri">https://jagowebdev.com/wp-content/demo/files/join_pada_mysql.sql.txt</a></li>
<li><a href="https://blog.devgenius.io/thelook-ecommerce-data-analysis-using-sql-2cf420de9095" class="uri">https://blog.devgenius.io/thelook-ecommerce-data-analysis-using-sql-2cf420de9095</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="perhitungan-statistik-dasar.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="w1h-visualisasi.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dsciencelabs/JNE_Data_Analytics_PySQL/edit/master/chapters/04-Join_Subkueri.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["JNE_Py_SQL.pdf", "JNE_Py_SQL.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
